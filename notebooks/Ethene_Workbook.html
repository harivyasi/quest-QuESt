
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ethene Molecule &#8212; Q³ Qiskit QuESt Qalculator</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="QuESt" href="../README.html" />
    <link rel="prev" title="H2O Molecule" href="Water_bond_stretching.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Q³ Qiskit QuESt Qalculator</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to Q³ Qiskit QuESt Qalculator
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../notebooks.html">
   Notebooks
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="main_notebook.html">
     Welcome to Q³
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Water_bond_stretching.html">
     H2O Molecule
     <br/>
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Ethene Molecule
     <br/>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../README.html">
   QuESt
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/Ethene_Workbook.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        
        <a class="issues-button"
            href="https://github.com/QuESt-Calculator/QuESt//issues/new?title=Issue%20on%20page%20%2Fnotebooks/Ethene_Workbook.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/QuESt-Calculator/QuESt/edit/main/notebooks/Ethene_Workbook.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/QuESt-Calculator/QuESt/main?urlpath=lab/tree/notebooks/Ethene_Workbook.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Ethene Molecule
   <br/>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#libraries">
     Libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-a-pyscf-molecule">
   Defining a PySCF molecule
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#understand-the-hf-problem-classically">
   Understand the HF problem Classically
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualization-of-the-molecular-orbitals">
   Visualization of the Molecular Orbitals
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hartree-fock-embedding">
   Hartree-Fock Embedding
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-recent-publication-of-a-method-shows-how-to-simulate-bigger-molecules-with-a-strong-degree-of-accuracy">
     A recent
     <strong>
      publication
     </strong>
     of a method shows how to simulate bigger molecules with a strong degree of accuracy
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#qiskit-nature-and-pyscf-driver">
   Qiskit Nature and PySCF driver
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quantum-active-space">
   Quantum-Active-Space
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mapping-the-second-quantization-problem">
   Mapping the second quantization problem
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#qubitconverter">
   QubitConverter
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#starting-the-vqe">
   Starting the VQE
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#describing-an-initial-state">
   Describing an Initial State
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ansatz">
   Ansatz
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#backend-and-the-ibmq-experience">
     Backend and the IBMQ Experience
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimizer">
   Optimizer
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#solving-the-ground-state-energy">
   Solving the Ground State Energy
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#classical-solution">
   Classical solution
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vqe-and-initial-parameters-for-the-ansatz">
   VQE and initial parameters for the ansatz
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simulation-on-the-ibmq-experience">
   Simulation on the IBMQ Experience
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="ethene-molecule-br">
<h1>Ethene Molecule  <br><a class="headerlink" href="#ethene-molecule-br" title="Permalink to this headline">¶</a></h1>
<p><img alt="Ethene_Monomer.gif" src="../_images/Ethene_Monomer.gif" /></p>
<p>The following notebook aims to explain the process of calculating slight bigger molecular systems using the <strong>Active Space Transformer</strong> Function.<br>
This initiates the process of <strong>Embedding</strong> which will allow us to compute energies of certain electrons and molecular orbitals (MO’s) in a quantum computer, leaving the rest of the MO’s to be calcualted classically.</p>
<p>The following notebook is divided in:</p>
<ol class="simple">
<li><p>Libraries and certain considerations</p></li>
<li><p>Defintion of the molecule using PySCF</p></li>
<li><p>Defining the Hartree-Fock problem “Classically”</p></li>
<li><p>Analyze the Molecular Orbitals for Active Space</p></li>
<li><p>Embedding and Electronic Structure problem</p></li>
<li><p>The Quantum-Active Space</p></li>
<li><p>Defining the Hartree-Fock problem “Quantum”</p></li>
<li><p>Mapping your problem to Qubits</p></li>
<li><p>The Variational Quantum Eigensolver (VQE)</p>
<ol class="simple">
<li><p>Initialize your Quantu-Hartree Fock State</p></li>
<li><p>Physical and Heuristic Ansatz</p></li>
<li><p>Optimizers</p></li>
</ol>
</li>
<li><p>Solving the Groundstate</p>
<ol class="simple">
<li><p>Classical Eigensolver (Numpy)</p></li>
<li><p>Local-VQE (Qiskit-Nature)</p></li>
<li><p>IBMQ-Backends (IBMQ Experience)</p></li>
</ol>
</li>
<li><p>View Results</p>
<ol class="simple">
<li><p>What to compare</p></li>
<li><p>What to look for</p></li>
</ol>
</li>
</ol>
<div class="section" id="libraries">
<h2>Libraries<a class="headerlink" href="#libraries" title="Permalink to this headline">¶</a></h2>
<p><img alt="Libraries.gif" src="../_images/Libraries.gif" /></p>
<p>Needless to say, the installation of Qiskit, Qiskit-Nature, PySCF, py3Dmol are important for the full functionally of this notebook as well as common python science libraries.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">pyscf</span> <span class="kn">import</span> <span class="n">gto</span><span class="p">,</span> <span class="n">scf</span><span class="p">,</span> <span class="n">mcscf</span><span class="p">,</span> <span class="n">mp</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="n">dft</span><span class="p">,</span> <span class="n">ao2mo</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">fci</span>
<span class="kn">from</span> <span class="nn">pyscf.tools</span> <span class="kn">import</span> <span class="n">molden</span><span class="p">,</span> <span class="n">cubegen</span>
<span class="kn">from</span> <span class="nn">pyscf.geomopt.geometric_solver</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.drivers</span> <span class="kn">import</span> <span class="n">PySCFDriver</span><span class="p">,</span> <span class="n">UnitsType</span><span class="p">,</span> <span class="n">Molecule</span><span class="p">,</span>  <span class="n">HFMethodType</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.problems.second_quantization.electronic</span> <span class="kn">import</span> <span class="n">ElectronicStructureProblem</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.converters.second_quantization</span> <span class="kn">import</span> <span class="n">QubitConverter</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.mappers.second_quantization</span> <span class="kn">import</span> <span class="n">ParityMapper</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.transformers</span> <span class="kn">import</span> <span class="n">ActiveSpaceTransformer</span><span class="p">,</span> <span class="n">FreezeCoreTransformer</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms</span> <span class="kn">import</span> <span class="n">NumPyMinimumEigensolver</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.algorithms.ground_state_solvers</span> <span class="kn">import</span> <span class="n">GroundStateEigensolver</span>
<span class="c1">#import basis_set_exchange</span>

<span class="c1"># qiskit</span>
<span class="kn">from</span> <span class="nn">qiskit.utils</span> <span class="kn">import</span> <span class="n">QuantumInstance</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">Aer</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms.minimum_eigen_solvers</span> <span class="kn">import</span> <span class="n">NumPyMinimumEigensolver</span><span class="p">,</span> <span class="n">VQE</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms.optimizers</span> <span class="kn">import</span> <span class="n">SLSQP</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">ExcitationPreserving</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">BasicAer</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms</span> <span class="kn">import</span> <span class="n">NumPyMinimumEigensolver</span><span class="p">,</span> <span class="n">VQE</span>
<span class="kn">from</span> <span class="nn">qiskit.algorithms.optimizers</span> <span class="kn">import</span> <span class="n">SLSQP</span>

<span class="c1"># qiskit nature imports</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.problems.second_quantization</span> <span class="kn">import</span> <span class="n">ElectronicStructureProblem</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.converters.second_quantization</span> <span class="kn">import</span> <span class="n">QubitConverter</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.mappers.second_quantization</span> <span class="kn">import</span> <span class="n">JordanWignerMapper</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.algorithms</span> <span class="kn">import</span> <span class="n">GroundStateEigensolver</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.drivers</span> <span class="kn">import</span> <span class="n">PySCFDriver</span><span class="p">,</span> <span class="n">UnitsType</span><span class="p">,</span> <span class="n">Molecule</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.algorithms.pes_samplers</span> <span class="kn">import</span> <span class="n">BOPESSampler</span><span class="p">,</span> <span class="n">Extrapolator</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="defining-a-pyscf-molecule">
<h1>Defining a PySCF molecule<a class="headerlink" href="#defining-a-pyscf-molecule" title="Permalink to this headline">¶</a></h1>
<p>![PySCF Molecule.gif](PySCF Molecule.gif)</p>
<p>You can design your structure online or upload any coordinates of your structure. <br>
The allowed format for PySCF molecules come in the XYZ for Mol format. <br>
In PySCF you can define very important features of your classical calculation:</p>
<ul class="simple">
<li><p>symmetry –&gt; Set to True</p></li>
<li><p>spin</p></li>
<li><p>charge</p></li>
<li><p>unit (set to Angstroms)</p></li>
<li><p>name of output</p></li>
<li><p>basis set –&gt; <strong>Very important!</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Function to define a molecule with the GTO class</span>
<span class="k">def</span> <span class="nf">my_pyscf_mol</span><span class="p">(</span><span class="n">xyz</span> <span class="p">,</span><span class="n">symmetry</span><span class="p">,</span> <span class="n">spin</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="n">my_molecule</span> <span class="o">=</span> <span class="n">gto</span><span class="o">.</span><span class="n">Mole</span><span class="p">()</span>
    <span class="n">my_molecule</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">xyz</span><span class="p">))</span>
    <span class="n">my_molecule</span><span class="o">.</span><span class="n">symmetry</span> <span class="o">=</span> <span class="n">symmetry</span>
    <span class="n">my_molecule</span><span class="o">.</span><span class="n">spin</span> <span class="o">=</span> <span class="n">spin</span>
    <span class="n">my_molecule</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span>
    <span class="n">my_molecule</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">units</span>
    <span class="n">my_moleculeverbose</span> <span class="o">=</span> <span class="mi">1</span> 
    <span class="n">my_molecule</span><span class="o">.</span><span class="n">basis</span> <span class="o">=</span> <span class="n">basis</span>
    <span class="n">my_molecule</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">output</span>
    <span class="n">my_molecule</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">my_molecule</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Read HF Optimized structures</span>

<span class="n">opt_sto3g</span> <span class="o">=</span> <span class="n">my_pyscf_mol</span><span class="p">(</span><span class="n">xyz</span><span class="o">=</span><span class="s2">&quot;Ethene_Monomer.xyz&quot;</span><span class="p">,</span>
                         <span class="n">symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                         <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
                         <span class="n">units</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> 
                         <span class="n">output</span><span class="o">=</span><span class="s1">&#39;opt_sto3g.out&#39;</span><span class="p">,</span>
                         <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;sto3g&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>overwrite output file: opt_sto3g.out
</pre></div>
</div>
</div>
</div>
<p>Now we calculate the meand field. <br>
We decide to calculate a Restrictired Shell Hartree-Fock simulation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#STO-3G Basis set</span>
<span class="n">mf_opt_sto3g</span> <span class="o">=</span> <span class="n">scf</span><span class="o">.</span><span class="n">RHF</span><span class="p">(</span><span class="n">opt_sto3g</span><span class="p">)</span>
<span class="n">mf_opt_sto3g</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-77.07229614334861
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="understand-the-hf-problem-classically">
<h1>Understand the HF problem Classically<a class="headerlink" href="#understand-the-hf-problem-classically" title="Permalink to this headline">¶</a></h1>
<p>Lets generate the MO diagram of the problem of interest</p>
<div class="alert alert-block alert-info">
<b>Tip:</b>Be aware that the MO's are determined by the basis set.
    Basis sets have a long developing history and have a high varierty. 
    We develop this problem with the simplest and most pictographical of the basis sets.
</div>
<p>Plenty of basis sets are available in PySCF in <strong><a class="reference external" href="https://github.com/pyscf/pyscf/tree/master/pyscf/gto/basis">here</a></strong> <br>
<br>
With STO-3G you get 14 Orbitals for C2H4, 8 Occupied and 6 Unoccupied <br>
<br>
This part is important to understand for the Active Space formulation <br>
<br>
The results are vizualized in the plot you’ll se below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.lines</span> <span class="kn">import</span> <span class="n">Line2D</span>

<span class="c1">#Energies and occupation </span>
<span class="n">Energies</span> <span class="o">=</span> <span class="n">mf_opt_sto3g</span><span class="o">.</span><span class="n">mo_energy</span> <span class="c1"># Energies</span>
<span class="n">Occupation</span> <span class="o">=</span> <span class="n">mf_opt_sto3g</span><span class="o">.</span><span class="n">mo_occ</span><span class="o">/</span><span class="mi">2</span> <span class="c1"># Number of occupied orbitals</span>
<span class="n">Orbital_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Occupation</span><span class="p">))</span> <span class="c1"># Number of orbitals within the basis set used</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Energies</span><span class="p">))</span>
<span class="c1">#Get to arrays with occupied and unoccupied MO</span>
<span class="n">counter</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Occupation</span><span class="p">)</span>  
<span class="n">occ_mo</span> <span class="o">=</span> <span class="n">Energies</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">counter</span><span class="p">)]</span>
<span class="n">x_occ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">occ_mo</span><span class="p">))</span>
<span class="n">unocc_mo</span> <span class="o">=</span> <span class="n">Energies</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">counter</span><span class="p">):</span><span class="nb">len</span><span class="p">(</span><span class="n">Energies</span><span class="p">)]</span>
<span class="n">x_unocc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unocc_mo</span><span class="p">))</span>

<span class="n">mo_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Energies</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span>


<span class="n">x_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Energies</span><span class="p">))</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">Energies</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">Energies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">Energies</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">temp</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">:</span>
        <span class="n">x_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">temp</span> <span class="o">&lt;</span> <span class="mf">0.2</span><span class="p">:</span>
        <span class="n">x_new</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.04</span>
        <span class="n">x_new</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.04</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span>

<span class="n">x_occ</span> <span class="o">=</span> <span class="n">x_new</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="n">counter</span><span class="p">)]</span>
<span class="n">x_unocc</span> <span class="o">=</span> <span class="n">x_new</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">counter</span><span class="p">):</span><span class="nb">len</span><span class="p">(</span><span class="n">Energies</span><span class="p">)]</span>
<span class="c1">#Plotting occupied and unoccupied in red and blue</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_occ</span><span class="p">,</span> <span class="n">occ_mo</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1444</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_unocc</span><span class="p">,</span> <span class="n">unocc_mo</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;crimson&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1444</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1">#Define limits</span>
<span class="n">low_lim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span> <span class="c1"># HOMO-2</span>
<span class="n">top_lim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">counter</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span> <span class="c1"># LUMO+2</span>

<span class="k">if</span> <span class="n">top_lim</span> <span class="o">&gt;</span> <span class="n">Orbital_number</span><span class="p">:</span>
    <span class="n">top_lim</span> <span class="o">=</span> <span class="n">Orbital_number</span>

<span class="k">if</span> <span class="n">low_lim</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">low_lim</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1">#Put the index of a range HOMO-2 and LUMO+2 (This can be an option)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">low_lim</span><span class="p">,</span><span class="n">top_lim</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">index</span> <span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">x_new</span><span class="p">[</span><span class="n">index</span><span class="p">],</span><span class="n">Energies</span><span class="p">[</span><span class="n">index</span><span class="p">]),</span><span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="n">x_new</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">-</span><span class="mf">0.015</span><span class="p">,</span><span class="n">Energies</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="p">,</span><span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span> <span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy [a.u]&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;MO&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">legend_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Occu.&#39;</span><span class="p">),</span> <span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;crimson&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Unoccup&#39;</span><span class="p">),]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_elements</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span> <span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span> <span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#Put the limits in y- HOMO-3 and LUMO+4 (This can be an option)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">Energies</span><span class="p">[</span><span class="n">low_lim</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Energies</span><span class="p">[</span><span class="n">top_lim</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.1</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([], [])
</pre></div>
</div>
<img alt="../_images/Ethene_Workbook_9_1.png" src="../_images/Ethene_Workbook_9_1.png" />
</div>
</div>
</div>
<div class="section" id="visualization-of-the-molecular-orbitals">
<h1>Visualization of the Molecular Orbitals<a class="headerlink" href="#visualization-of-the-molecular-orbitals" title="Permalink to this headline">¶</a></h1>
<p>For clarity and to follow a more pictographic path, we take a look at each of the MOs. <br></p>
<p>Especially if they are close to the Fermi level. <br></p>
<p>That is, around MO’s 7, 8, 9, 10. <br></p>
<p>For your comfort and curiosity, you can visualize the isosurface of the MOs wavefunctions. <br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Function to read XYZ files</span>
<span class="k">def</span> <span class="nf">readXYZ</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">filelength</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="n">progress</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">geomcount</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">geom</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">progress</span> <span class="o">&lt;</span> <span class="n">filelength</span><span class="p">:</span>
        <span class="n">tmpgeom</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">progress</span><span class="p">])</span><span class="o">+</span><span class="mi">2</span>
        <span class="n">rangestart</span> <span class="o">=</span> <span class="n">progress</span>
        <span class="n">rangeend</span> <span class="o">=</span> <span class="n">progress</span> <span class="o">+</span> <span class="n">length</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rangestart</span><span class="p">,</span> <span class="n">rangeend</span><span class="p">):</span>
            <span class="n">tmpgeom</span> <span class="o">=</span> <span class="n">tmpgeom</span> <span class="o">+</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">geom</span> <span class="o">=</span> <span class="n">geom</span> <span class="o">+</span> <span class="p">[</span><span class="n">tmpgeom</span><span class="p">]</span>
        <span class="n">geomcount</span> <span class="o">=</span> <span class="n">geomcount</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="n">progress</span> <span class="o">+</span> <span class="n">length</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">geom</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Interactive selection of the functional of Interest</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">py3Dmol</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">index_i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">cubegen</span><span class="o">.</span><span class="n">orbital</span><span class="p">(</span><span class="n">opt_sto3g</span><span class="p">,</span> <span class="s1">&#39;temp.cube&#39;</span><span class="p">,</span> <span class="n">mf_opt_sto3g</span><span class="o">.</span><span class="n">mo_coeff</span><span class="p">[:,</span><span class="n">index_i</span><span class="p">])</span>
    <span class="n">orbital_mol</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;temp.cube&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">py3Dmol</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
    <span class="n">v</span><span class="o">.</span><span class="n">addVolumetricData</span><span class="p">(</span><span class="n">orbital_mol</span><span class="p">,</span> <span class="s2">&quot;cube&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;isoval&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s1">&#39;opacity&#39;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">})</span>
    <span class="n">v</span><span class="o">.</span><span class="n">addVolumetricData</span><span class="p">(</span><span class="n">orbital_mol</span><span class="p">,</span> <span class="s2">&quot;cube&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;isoval&#39;</span><span class="p">:</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s1">&#39;opacity&#39;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">})</span>
    <span class="n">geom</span> <span class="o">=</span> <span class="n">readXYZ</span><span class="p">(</span><span class="s2">&quot;Ethene_Monomer.xyz&quot;</span><span class="p">)</span>
    <span class="n">v</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:{}})</span>
    <span class="n">v</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
    <span class="n">v</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span><span class="s2">&quot;xyz&quot;</span><span class="p">)</span>
    <span class="n">v</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:{}})</span>
    <span class="n">v</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#You can remove the comment to the different orbitals</span>
<span class="n">interact</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">mo_numbers</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "e2c2cd33c0904dbcb39ba01da1747944", "version_major": 2, "version_minor": 0}
</script></div>
</div>
</div>
<div class="section" id="hartree-fock-embedding">
<h1>Hartree-Fock Embedding<a class="headerlink" href="#hartree-fock-embedding" title="Permalink to this headline">¶</a></h1>
<div class="section" id="a-recent-publication-of-a-method-shows-how-to-simulate-bigger-molecules-with-a-strong-degree-of-accuracy">
<h2>A recent <strong><a class="reference external" href="https://aip.scitation.org/doi/10.1063/5.0029536">publication</a></strong> of a method shows how to simulate bigger molecules with a strong degree of accuracy<a class="headerlink" href="#a-recent-publication-of-a-method-shows-how-to-simulate-bigger-molecules-with-a-strong-degree-of-accuracy" title="Permalink to this headline">¶</a></h2>
<p>It goes like this:</p>
<ul class="simple">
<li><p>Definition of Inactive and Active space</p></li>
</ul>
<p>We derive the so-called inactive Fock operator. The goal of this operator is to embed the quantum computation into a classically computed environment treated at the HF level of theory, through the notion of an AS.</p>
<p>The total electronic energy, <span class="math notranslate nohighlight">\(E\)</span>, is defined by the expectation value of the system Hamiltonian, <span class="math notranslate nohighlight">\(\hat{H} \)</span>
$<span class="math notranslate nohighlight">\(E = ⟨Ψ∣H∣Ψ⟩ = \sum_{pq} h_{pq}D_{pq} + \frac{1}{2} \sum_{pqrs} g_{pqrs}d_{pqrs}\)</span><span class="math notranslate nohighlight">\(,
where \)</span>Ψ<span class="math notranslate nohighlight">\( is the wavefunction, \)</span>h_{pq}<span class="math notranslate nohighlight">\( and \)</span>g_{pqrs}$ are the one- and two- electron integrals, respectively, and D and d are the one- and two- particle density matrices.</p>
<p><span class="math notranslate nohighlight">\(h_{pq}\rightarrow\)</span> One electron Integral <br>
<span class="math notranslate nohighlight">\(g_{pqrs}\rightarrow\)</span> Two electron Intagral <br></p>
<p>To achieve the implementation of the HF embedding, we split the one-electron density (D) into an active and inactive part, <span class="math notranslate nohighlight">\(D = D^A+D^I\)</span>
In the MO basis, the latter simplifies to <span class="math notranslate nohighlight">\(D_{iq} = 2δ_{iq}\)</span>, where we
use Helgaker’s index notation in which <strong>i, j, k, l</strong> denote inactive, <strong>u, v, x, y</strong> denote active, and <strong>p, q, r, s</strong> denote general MOs.<br></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Inactive</p></th>
<th class="text-align:center head"><p>Active</p></th>
<th class="text-align:center head"><p>MO</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>i</p></td>
<td class="text-align:center"><p>u</p></td>
<td class="text-align:center"><p>p</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>j</p></td>
<td class="text-align:center"><p>v</p></td>
<td class="text-align:center"><p>q</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>k</p></td>
<td class="text-align:center"><p>x</p></td>
<td class="text-align:center"><p>r</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>l</p></td>
<td class="text-align:center"><p>y</p></td>
<td class="text-align:center"><p>s</p></td>
</tr>
</tbody>
</table>
<p>The one electron contribution is:
$<span class="math notranslate nohighlight">\( \sum_{pq} h_{pq}D_{pq} = \sum_{vq}h_{vq}D_{vq}^A + \sum_{jq}h_{jq}D_{jq}^I \)</span><span class="math notranslate nohighlight">\(  we use the fact that a density matrix element vanishes when any of its indices correspond to a virtual orbital to obtain:
\)</span><span class="math notranslate nohighlight">\( \sum_{pq} h_{pq}D_{pq} = \sum_{uv}h_{uv}D_{uv}^A + 2 \sum_{jq}h_{jj} \)</span>$</p>
<p>and the two electorn contribution is:
$<span class="math notranslate nohighlight">\( \frac{1}{2} \sum_{pqrs}g_{pqrs}d_{pqrs} =\frac{1}{2} \sum_{pqjs}g_{pqjs}d_{pqjs} + \frac{1}{2} \sum_{jqus}g_{jqus}d_{jqus} + \frac{1}{2} \sum_{vqus}g_{vqus}d_{vqus} \)</span>$</p>
<p><strong>one important point</strong> is how to represent the two electron density matrices using one electron density matrices. <br>
Express the two-electron density matrices in terms of one-electron ones: <br>
$<span class="math notranslate nohighlight">\(d_{pqjs} = (2\rho_{js}- \rho_{qj} \rho_{sq})D_{pq}\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(d_{jqus} = (2\rho_{qj} \rho_{sq}- \rho_{sj})D_{uq}\)</span>$</p>
<p>The Inactive Fock Operator is then:<br></p>
<div class="math notranslate nohighlight">
\[F_{pq}^{I} = h_{pq} + \sum_{i}(2g_{iipq}-g_{iqpi})\]</div>
<p>and its energy is: <br></p>
<div class="math notranslate nohighlight">
\[ E^I = \frac{1}{2}\sum_{ij}(h_{jj}+F_{ij}^I)D_{ij}^I \]</div>
<p>as such, we redifine our total energy as: <br></p>
<div class="math notranslate nohighlight">
\[ E = E^I + \sum_{uv}F_{uv}^I D_{uv}^A + \frac{1}{2}\sum_{uvxy} g_{uvxy}d_{uvxy}^A \]</div>
<p>and at last our hamiltonian is then: <br></p>
<div class="math notranslate nohighlight">
\[ \hat{H} =\sum_{uv}F_{uv}^I \hat{a}_u^\dagger\hat{a}_v + \sum_{uvxy}g_{uvxy} \hat{a}_u^\dagger \hat{a}_v^\dagger \hat{a}_x \hat{a}_y \]</div>
<p><strong>This <span class="math notranslate nohighlight">\(\hat{H}\)</span> will go into the quantum computer now.</strong></p>
</div>
</div>
<div class="section" id="qiskit-nature-and-pyscf-driver">
<h1>Qiskit Nature and PySCF driver<a class="headerlink" href="#qiskit-nature-and-pyscf-driver" title="Permalink to this headline">¶</a></h1>
<p>This step is the link between the classical computation in PySCF and the quantum computing process taken over by IBMQ. <br></p>
<p>The class <code class="docutils literal notranslate"><span class="pre">Molecule</span></code> defines <strong>QMolecule</strong> which is Qiskit definition of the molecule.<br>
The driver <code class="docutils literal notranslate"><span class="pre">PySCFDriver</span></code> translates the information of the Qmolecule object from the PySCF library.<br>
The hf_method parameter defines the if the restricted (RHF), unrestircted (UHF) or restricted-open (ROHF) configurations are used <br>
Finally, by running the driver we form the new Qmolecule object for Qiskit Nature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit_nature.drivers</span> <span class="kn">import</span> <span class="n">PySCFDriver</span><span class="p">,</span> <span class="n">UnitsType</span><span class="p">,</span> <span class="n">Molecule</span> <span class="p">,</span> <span class="n">HFMethodType</span>

<span class="c1">#using the class Molecule (From Qiskit Nature) we can make an object for PySCFDriver</span>
<span class="c1">#opt_sto3g is the GTO objectr from PySCF , in this case the optimized structure</span>

<span class="n">molecule</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">geometry</span><span class="o">=</span> <span class="n">opt_sto3g</span><span class="o">.</span><span class="n">atom</span> <span class="p">,</span><span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">multiplicity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  

<span class="c1">#We call the PySCFDriver and we provided our define molecule object (molecule)</span>
<span class="c1">#Within the driver we define the units (ANGSTROM), basis using the GTO PySCF driver and hf_method RHF UHF or ROHF</span>

<span class="n">driver</span> <span class="o">=</span> <span class="n">PySCFDriver</span><span class="p">(</span><span class="n">molecule</span><span class="o">=</span><span class="n">molecule</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">UnitsType</span><span class="o">.</span><span class="n">ANGSTROM</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="n">opt_sto3g</span><span class="o">.</span><span class="n">basis</span><span class="p">,</span> <span class="n">hf_method</span><span class="o">=</span><span class="n">HFMethodType</span><span class="o">.</span><span class="n">RHF</span><span class="p">)</span>

<span class="c1"># #Running PySCF it prints convergence True or False (Important), Total Energy , Electronic dipole and Total dipole</span>
<span class="c1">#run PySCF with the use of the PySCFDriver and what we will know as quantum molecule </span>
<span class="n">q_molecule</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="quantum-active-space">
<h1>Quantum-Active-Space<a class="headerlink" href="#quantum-active-space" title="Permalink to this headline">¶</a></h1>
<p><img alt="ImagesActive_Space.gif" src="notebooks/attachment:ImagesActive_Space.gif" /></p>
<p>By calling the function <code class="docutils literal notranslate"><span class="pre">ActiveSpaceTransformer</span></code> you can customize your quantum active space.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">num_electrons</span></code>= (n)</p>
<ul>
<li><p>The number of active electrons. If this is a tuple, it represents the number of alpha and beta electrons.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_molecular_orbitals</span></code>(n)</p>
<ul>
<li><p>The number of active orbitals</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">active_orbitals</span></code>=[int,int,int,int]</p>
<ul>
<li><p>A list of indices specifying the molecular orbitals of the active space</p></li>
</ul>
</li>
</ul>
<p>C2H4 with the STO-3G basis set has 14 MO orbitals, where 8 are occupied. <br>
In this example we want to use 4 occupied electrons and 4 orbitals to simulate. <br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Based on the number of MO within the basis define the occupied and unoccupied virtuals </span>

<span class="c1">#ActiveSpaceTransformer will be use to selected the active space from the q_molecule MO representation</span>
<span class="c1">#You can define as (2,3) (#electrons, #orbitals) </span>
<span class="c1">#The selection of the MO is around the HOMO</span>
<span class="n">active_space_trafo</span> <span class="o">=</span> <span class="n">ActiveSpaceTransformer</span><span class="p">(</span><span class="n">num_electrons</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">num_molecular_orbitals</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">active_orbitals</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1">#Another option is to specificalle define the index of the MO orbitals</span>
<span class="c1">#active_space_trafo_2_3 = ActiveSpaceTransformer(num_electrons=2,num_molecular_orbitals=3,active_orbitals=[4,5,6])</span>

<span class="c1">#Example (4,4) , Active Space HOMO-1, HOMO, LUMO and LUMO+1 (4,5,6,7 from the MO Energy diagram displayed above)</span>
<span class="c1">#active_space_trafo_4_4 = ActiveSpaceTransformer(num_electrons=2,num_molecular_orbitals=4)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mapping-the-second-quantization-problem">
<h1>Mapping the second quantization problem<a class="headerlink" href="#mapping-the-second-quantization-problem" title="Permalink to this headline">¶</a></h1>
<p>The translation of the recently computed hamiltonian into the qubit formalism is called Mapping. <br></p>
<p>This part <strong>is</strong> where things get <em>quantum</em> quantum, not <em>classically</em> quantum, if you know what I mean.</p>
<p><img alt="Mapping.gif" src="../_images/Mapping.gif" /></p>
<p>by the way, these AMAZING animations of gates are a masterpiece of <em><a class="reference external" href="https://github.com/cduck">Casey Duckering</a></em></p>
<p>Here is an important step in your calculation. <br>
You can customize your electronic structure probem and its paramenters like Quantum Active space. <br>
Using <code class="docutils literal notranslate"><span class="pre">ElectronicStructureProblem</span></code> you need to call your <em>driver</em> which if you remember, has the information of your entire molecule and its characteristics from PySCF into Qiskit.<br>
<em>q_molecule_transformers</em> is a list where you pass the fucntion <code class="docutils literal notranslate"><span class="pre">ActiveSpaceTransformer</span></code><br></p>
<p><strong>Important</strong> If you pass only the <em>driver</em> without the Quantum Active space you will require all the MOs to be transformed to quibits.
Compare using it which requires ony 6 qubits, with 28 qubits required for a full quantum calculation</p>
<p>In order to learn more about how is the second quantization formed in the qubit formalism, take a look in the class <code class="docutils literal notranslate"><span class="pre">.second_q_ops()</span></code> if the <code class="docutils literal notranslate"><span class="pre">ElectronisStructureProblem</span></code> function.</p>
<p>The indexes of <code class="docutils literal notranslate"><span class="pre">.second_q_ops()[n]</span></code> are for n:</p>
<ul class="simple">
<li><p>Electronic Structure operator a.k.a. “Hamiltonian” or 𝐻</p></li>
<li><p>Total Magnetization operator</p></li>
<li><p>Total Angular Momentum operator</p></li>
<li><p>Total Particle Number operator</p></li>
<li><p>x Dipole operator</p></li>
<li><p>y Dipole operator</p></li>
<li><p>z Dipole operator</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Defining the electronic structure problem </span>
<span class="c1"># We provide our PySCFDriver object and the active space (q_molecule_transformers)</span>

<span class="n">es_problem</span> <span class="o">=</span> <span class="n">ElectronicStructureProblem</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="n">q_molecule_transformers</span><span class="o">=</span><span class="p">[</span><span class="n">active_space_trafo</span><span class="p">])</span>

<span class="c1"># If we want to consider all the MOs for the qubit simulation, we do not use q_molecule_transformes</span>
<span class="c1"># es_problem = ElectronicStructureProblem(driver)</span>

<span class="c1"># Generate the second-quantized operators</span>
<span class="n">second_q_ops</span> <span class="o">=</span> <span class="n">es_problem</span><span class="o">.</span><span class="n">second_q_ops</span><span class="p">()</span>

<span class="c1"># Hamiltonian</span>
<span class="n">main_op</span> <span class="o">=</span> <span class="n">es_problem</span><span class="o">.</span><span class="n">second_q_ops</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">main_op</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  ++--IIII * (0.0054968815974945065+0j)
+ +-+-IIII * (-0.006988847787710562+0j)
+ +--+IIII * (0.0014919661902160178+0j)
+ +-II+-II * (0.008683101772372581+0j)
+ +-II+I-I * (1.1549407843178087e-06+0j)
+ +-II-+II * (-0.008683101772372581+0j)
+ +-II-I+I * (-1.1549407843178087e-06+0j)
+ +-III+I- * (1.1535946452248189e-06+0j)
+ +-III-I+ * (-1.1535946452243852e-06+0j)
+ +-IIII+- * (0.0068397289751179705+0j)
+ +-IIII-+ * (-0.0068397289751179705+0j)
+ +I-I+-II * (1.1549407843178087e-06+0j)
+ +I-I+I-I * (0.011309976507716207+0j)
+ +I-I-+II * (-1.154940784317592e-06+0j)
+ +I-I-I+I * (-0.011309976507716205+0j)
+ +I-II+I- * (0.00833169516533399+0j)
+ +I-II-I+ * (-0.008331695165333988+0j)
+ +I-III+- * (1.349952093238115e-06+0j)
+ +I-III-+ * (-1.3499520932383317e-06+0j)
+ +II-+II- * (0.054115024650205464+0j)
+ +II--II+ * (-0.05411502465020549+0j)
+ +II-I+-I * (0.013828576762828497+0j)
+ +II-I-+I * (-0.013828576762828532+0j)
+ +II-IIII * (-2.508044995364056e-05+0j)
+ +II-IIIN * (4.475293728449861e-06+0j)
+ +II-IINI * (1.3004704761102395e-05+0j)
+ +II-INII * (1.2823595036565941e-05+0j)
+ +II-NIII * (5.80060171276515e-07+0j)
+ +IN-IIII * (1.165475266786428e-05+0j)
+ +NI-IIII * (1.1670000391341123e-05+0j)
+ -++-IIII * (0.0014919661902160226+0j)
+ -+-+IIII * (-0.006988847787710543+0j)
+ -+II+-II * (-0.008683101772372581+0j)
+ -+II+I-I * (-1.154940784317592e-06+0j)
+ -+II-+II * (0.008683101772372581+0j)
+ -+II-I+I * (1.154940784317375e-06+0j)
+ -+III+I- * (-1.153594645224602e-06+0j)
+ -+III-I+ * (1.1535946452250357e-06+0j)
+ -+IIII+- * (-0.006839728975117967+0j)
+ -+IIII-+ * (0.00683972897511797+0j)
+ --++IIII * (0.00549688159749454+0j)
+ -I+I+-II * (-1.1549407843178087e-06+0j)
+ -I+I+I-I * (-0.011309976507716205+0j)
+ -I+I-+II * (1.154940784317375e-06+0j)
+ -I+I-I+I * (0.011309976507716207+0j)
+ -I+II+I- * (-0.00833169516533399+0j)
+ -I+II-I+ * (0.008331695165333986+0j)
+ -I+III+- * (-1.3499520932396328e-06+0j)
+ -I+III-+ * (1.3499520932396328e-06+0j)
+ -II++II- * (-0.05411502465020549+0j)
+ -II+-II+ * (0.05411502465020548+0j)
+ -II+I+-I * (-0.013828576762828513+0j)
+ -II+I-+I * (0.013828576762828528+0j)
+ -II+IIII * (2.508044995364056e-05+0j)
+ -II+IIIN * (-4.4752937284290445e-06+0j)
+ -II+IINI * (-1.300470476107464e-05+0j)
+ -II+INII * (-1.2823595036558569e-05+0j)
+ -II+NIII * (-5.800601712521204e-07+0j)
+ -IN+IIII * (-1.1654752667835007e-05+0j)
+ -NI+IIII * (-1.1670000391333533e-05+0j)
+ I+-I+II- * (0.013828576762828497+0j)
+ I+-I-II+ * (-0.013828576762828513+0j)
+ I+-II+-I * (0.1717126320421397+0j)
+ I+-II-+I * (-0.17171263204213974+0j)
+ I+-IIIII * (-2.3191640453945617e-05+0j)
+ I+-IIIIN * (1.5790578333703745e-05+0j)
+ I+-IIINI * (1.316161893832879e-06+0j)
+ I+-IINII * (-1.3802660034437086e-06+0j)
+ I+-INIII * (1.2842362893006332e-05+0j)
+ I+-NIIII * (1.4251849964113912e-05+0j)
+ I+I-+-II * (1.1535946452248189e-06+0j)
+ I+I-+I-I * (0.00833169516533399+0j)
+ I+I--+II * (-1.153594645224602e-06+0j)
+ I+I--I+I * (-0.00833169516533399+0j)
+ I+I-I+I- * (0.010428325167044884+0j)
+ I+I-I-I+ * (-0.01042832516704488+0j)
+ I+I-II+- * (1.5387283695878808e-06+0j)
+ I+I-II-+ * (-1.5387283695898323e-06+0j)
+ I-+I+II- * (-0.013828576762828532+0j)
+ I-+I-II+ * (0.013828576762828528+0j)
+ I-+II+-I * (-0.17171263204213974+0j)
+ I-+II-+I * (0.17171263204213974+0j)
+ I-+IIIII * (2.3191640453890106e-05+0j)
+ I-+IIIIN * (-1.579057833367252e-05+0j)
+ I-+IIINI * (-1.3161618938190012e-06+0j)
+ I-+IINII * (1.3802660034645253e-06+0j)
+ I-+INIII * (-1.2842362893027148e-05+0j)
+ I-+NIIII * (-1.4251849964084639e-05+0j)
+ I-I++-II * (-1.1535946452243852e-06+0j)
+ I-I++I-I * (-0.008331695165333988+0j)
+ I-I+-+II * (1.1535946452250357e-06+0j)
+ I-I+-I+I * (0.008331695165333986+0j)
+ I-I+I+I- * (-0.01042832516704488+0j)
+ I-I+I-I+ * (0.010428325167044875+0j)
+ I-I+II+- * (-1.5387283695878808e-06+0j)
+ I-I+II-+ * (1.5387283695922176e-06+0j)
+ II+-+-II * (0.0068397289751179705+0j)
+ II+-+I-I * (1.349952093238115e-06+0j)
+ II+--+II * (-0.006839728975117967+0j)
+ II+--I+I * (-1.3499520932396328e-06+0j)
+ II+-I+I- * (1.5387283695878808e-06+0j)
+ II+-I-I+ * (-1.5387283695878808e-06+0j)
+ II+-II+- * (0.00839004974198172+0j)
+ II+-II-+ * (-0.008390049741981714+0j)
+ II-++-II * (-0.0068397289751179705+0j)
+ II-++I-I * (-1.3499520932383317e-06+0j)
+ II-+-+II * (0.00683972897511797+0j)
+ II-+-I+I * (1.3499520932396328e-06+0j)
+ II-+I+I- * (-1.5387283695898323e-06+0j)
+ II-+I-I+ * (1.5387283695922176e-06+0j)
+ II-+II+- * (-0.008390049741981714+0j)
+ II-+II-+ * (0.008390049741981714+0j)
+ IIII++-- * (0.0054968815974945065+0j)
+ IIII+-+- * (-0.006988847787710562+0j)
+ IIII+--+ * (0.0014919661902160178+0j)
+ IIII+II- * (-2.508044995364056e-05+0j)
+ IIII+IN- * (1.165475266786428e-05+0j)
+ IIII+NI- * (1.1670000391341123e-05+0j)
+ IIII-++- * (0.0014919661902160226+0j)
+ IIII-+-+ * (-0.006988847787710543+0j)
+ IIII--++ * (0.00549688159749454+0j)
+ IIII-II+ * (2.508044995364056e-05+0j)
+ IIII-IN+ * (-1.1654752667835007e-05+0j)
+ IIII-NI+ * (-1.1670000391333533e-05+0j)
+ IIIII+-I * (-2.3191640453945617e-05+0j)
+ IIIII+-N * (1.4251849964113912e-05+0j)
+ IIIII-+I * (2.3191640453890106e-05+0j)
+ IIIII-+N * (-1.4251849964084639e-05+0j)
+ IIIIIIIN * (-0.8688936981326237+0j)
+ IIIIIINI * (-1.2874569723166327+0j)
+ IIIIIINN * (0.39359423621458856+0j)
+ IIIIINII * (-1.5769592873210556+0j)
+ IIIIININ * (0.3884538087893253+0j)
+ IIIIINNI * (0.33764420982558296+0j)
+ IIIIN+-I * (1.168742210868874e-05+0j)
+ IIIIN-+I * (-1.168742210870934e-05+0j)
+ IIIINIII * (-1.5999960643896403+0j)
+ IIIINIIN * (0.33151692909268826+0j)
+ IIIININI * (0.37411640693415293+0j)
+ IIIINNII * (0.3677980593537008+0j)
+ IIIN+II- * (4.475293728449861e-06+0j)
+ IIIN-II+ * (-4.4752937284290445e-06+0j)
+ IIINI+-I * (1.5790578333703745e-05+0j)
+ IIINI-+I * (-1.579057833367252e-05+0j)
+ IIINIIII * (-0.8688936981326237+0j)
+ IIINIIIN * (0.4034479855779787+0j)
+ IIINIINI * (0.4019842859565703+0j)
+ IIININII * (0.3988821339563702+0j)
+ IIINNIII * (0.3856319537428937+0j)
+ IINI+II- * (1.3004704761102395e-05+0j)
+ IINI-II+ * (-1.300470476107464e-05+0j)
+ IINII+-I * (1.316161893832879e-06+0j)
+ IINII-+I * (-1.3161618938190012e-06+0j)
+ IINIIIII * (-1.2874569723166327+0j)
+ IINIIIIN * (0.4019842859565703+0j)
+ IINIIINI * (0.5240625867021127+0j)
+ IINIINII * (0.5093568418677228+0j)
+ IININIII * (0.3854263834418692+0j)
+ IINNIIII * (0.39359423621458856+0j)
+ INII+II- * (1.2823595036565941e-05+0j)
+ INII-II+ * (-1.2823595036558569e-05+0j)
+ INIII+-I * (-1.3802660034437086e-06+0j)
+ INIII-+I * (1.3802660034645253e-06+0j)
+ INIIIIII * (-1.5769592873210556+0j)
+ INIIIIIN * (0.3988821339563702+0j)
+ INIIIINI * (0.5093568418677228+0j)
+ INIIINII * (0.5080521914708961+0j)
+ INIINIII * (0.37648116112607344+0j)
+ ININIIII * (0.3884538087893253+0j)
+ INNIIIII * (0.33764420982558296+0j)
+ N+-IIIII * (1.168742210868874e-05+0j)
+ N-+IIIII * (-1.168742210870934e-05+0j)
+ NIII+II- * (5.80060171276515e-07+0j)
+ NIII-II+ * (-5.800601712521204e-07+0j)
+ NIIII+-I * (1.2842362893006332e-05+0j)
+ NIIII-+I * (-1.2842362893027148e-05+0j)
+ NIIIIIII * (-1.5999960643896403+0j)
+ NIIIIIIN * (0.3856319537428937+0j)
+ NIIIIINI * (0.3854263834418692+0j)
+ NIIIINII * (0.37648116112607344+0j)
+ NIIINIII * (0.391841935176805+0j)
+ NIINIIII * (0.33151692909268826+0j)
+ NINIIIII * (0.37411640693415293+0j)
+ NNIIIIII * (0.3677980593537008+0j)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="qubitconverter">
<h1>QubitConverter<a class="headerlink" href="#qubitconverter" title="Permalink to this headline">¶</a></h1>
<p>Once we the second-quantization representation, we must translate this into a Quantum computing circuits. In order to simulate our MOs in a quantum computer. <br>
All known elementary and composite particles are bosons or fermions, depending on their spin: Particles with half-integer spin are fermions; particles with integer spin are bosons. In Quantum computing there are different algorithms to “mapped” this second quantize representation into qubits depending if the problems are Fermions or Bosons, since we are working with electrons (Fermions) we will use a selected group of Mapping algorithms for Fermion problems.</p>
<p><img alt="Mappers_Chemistry.gif" src="../_images/Mappers_Chemistry.gif" /></p>
<p>The <code class="docutils literal notranslate"><span class="pre">QubitConverter</span></code> is called to define the translate of your second quantization operators using the defined mapping.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Mapper</span></code>:</p>
<ul>
<li><p>We strongly suggest to stick with ‘JordanWignerMapper’ or with ‘BravyiKitaevMapper’ which are praised in the literature as the most relevant for quantum chemical simulation.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">two_qubit_reduction</span></code>:</p>
<ul>
<li><p>Is it s popular technique which uses ***** techniques to substract two or three qubits from the calculations</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">z2symmetry_reduction</span></code>:</p>
<ul>
<li><p>Can be set into ‘auto’ which will automaticall look for symmetries, this technique can be also customized, but the correct symmetries need to be added.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit_nature.mappers.second_quantization</span> <span class="kn">import</span> <span class="n">ParityMapper</span><span class="p">,</span> <span class="n">BravyiKitaevMapper</span><span class="p">,</span> <span class="n">JordanWignerMapper</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.converters.second_quantization.qubit_converter</span> <span class="kn">import</span> <span class="n">QubitConverter</span>

<span class="c1"># Setup the mapper and qubit converter</span>
<span class="c1">#For the choices we should have 3 ParityMapper, JordanWignerMapper and FermionicMapping</span>
<span class="n">mapper_type</span> <span class="o">=</span> <span class="s1">&#39;JordanWignerMapper&#39;</span>

<span class="k">if</span> <span class="n">mapper_type</span> <span class="o">==</span> <span class="s1">&#39;ParityMapper&#39;</span><span class="p">:</span>
    <span class="n">mapper</span> <span class="o">=</span> <span class="n">ParityMapper</span><span class="p">()</span>
<span class="k">elif</span> <span class="n">mapper_type</span> <span class="o">==</span> <span class="s1">&#39;JordanWignerMapper&#39;</span><span class="p">:</span>
    <span class="n">mapper</span> <span class="o">=</span> <span class="n">JordanWignerMapper</span><span class="p">()</span>
<span class="k">elif</span> <span class="n">mapper_type</span> <span class="o">==</span> <span class="s1">&#39;BravyiKitaevMapper&#39;</span><span class="p">:</span>
    <span class="n">mapper</span> <span class="o">=</span> <span class="n">BravyiKitaevMapper</span><span class="p">()</span>

<span class="n">converter</span> <span class="o">=</span> <span class="n">QubitConverter</span><span class="p">(</span><span class="n">mapper</span><span class="o">=</span><span class="n">mapper</span><span class="p">,</span> <span class="n">two_qubit_reduction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># The fermionic operators are mapped to qubit operators</span>
<span class="n">num_particles</span> <span class="o">=</span> <span class="p">(</span><span class="n">es_problem</span><span class="o">.</span><span class="n">molecule_data_transformed</span><span class="o">.</span><span class="n">num_alpha</span><span class="p">,</span>
             <span class="n">es_problem</span><span class="o">.</span><span class="n">molecule_data_transformed</span><span class="o">.</span><span class="n">num_beta</span><span class="p">)</span>
<span class="n">qubit_op</span> <span class="o">=</span> <span class="n">converter</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">main_op</span><span class="p">,</span> <span class="n">num_particles</span><span class="o">=</span><span class="n">num_particles</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="starting-the-vqe">
<h1>Starting the VQE<a class="headerlink" href="#starting-the-vqe" title="Permalink to this headline">¶</a></h1>
<p><img alt="VQE_1.gif" src="../_images/VQE_1.gif" /></p>
</div>
<div class="section" id="describing-an-initial-state">
<h1>Describing an Initial State<a class="headerlink" href="#describing-an-initial-state" title="Permalink to this headline">¶</a></h1>
<p>For our simulations, we will define an initial state for the mapped problem.
Since, we are simulating a molecule. We know that the best initial guess is to have all electrons occupying the lowest orbitals (Hund’s rule).<br></p>
<p>In this section, since we will give the initial state using the class <code class="docutils literal notranslate"><span class="pre">HartreeFock</span></code></p>
<ul class="simple">
<li><p>Electrons should occupy the lowest orbitals</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit_nature.circuit.library</span> <span class="kn">import</span> <span class="n">HartreeFock</span>

<span class="n">num_particles</span> <span class="o">=</span> <span class="p">(</span><span class="n">es_problem</span><span class="o">.</span><span class="n">molecule_data_transformed</span><span class="o">.</span><span class="n">num_alpha</span><span class="p">,</span>
             <span class="n">es_problem</span><span class="o">.</span><span class="n">molecule_data_transformed</span><span class="o">.</span><span class="n">num_beta</span><span class="p">)</span>
<span class="n">num_spin_orbitals</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">es_problem</span><span class="o">.</span><span class="n">molecule_data_transformed</span><span class="o">.</span><span class="n">num_molecular_orbitals</span>
<span class="n">init_state</span> <span class="o">=</span> <span class="n">HartreeFock</span><span class="p">(</span><span class="n">num_spin_orbitals</span><span class="p">,</span> <span class="n">num_particles</span><span class="p">,</span> <span class="n">converter</span><span class="p">)</span>
<span class="n">init_state</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;iqx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Ethene_Workbook_26_0.png" src="../_images/Ethene_Workbook_26_0.png" />
</div>
</div>
</div>
<div class="section" id="ansatz">
<h1>Ansatz<a class="headerlink" href="#ansatz" title="Permalink to this headline">¶</a></h1>
<p><img alt="Ansatz.gif" src="../_images/Ansatz.gif" /></p>
<p>This a complex field, and its explanation is nothing close than trivial.</p>
<p>Recomended Types:</p>
<ul class="simple">
<li><p><em><a class="reference external" href="https://aip.scitation.org/doi/10.1063/1.5141835">UCC(SD)</a></em></p></li>
<li><p><em><a class="reference external" href="https://arxiv.org/abs/1309.2736">EfficientSU2</a></em></p></li>
</ul>
<div class="cell tag_outputPrepend docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">TwoLocal</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.circuit.library</span> <span class="kn">import</span> <span class="n">UCCSD</span><span class="p">,</span> <span class="n">PUCCD</span><span class="p">,</span> <span class="n">SUCCD</span>
<span class="kn">from</span> <span class="nn">qiskit.circuit.library</span> <span class="kn">import</span> <span class="n">EfficientSU2</span>

<span class="c1"># Choose the ansatz</span>
<span class="n">ansatz_type</span> <span class="o">=</span> <span class="s2">&quot;UCCSD&quot;</span>

<span class="c1"># Put arguments for twolocal</span>
<span class="k">if</span> <span class="n">ansatz_type</span> <span class="o">==</span> <span class="s2">&quot;TwoLocal&quot;</span><span class="p">:</span>
    <span class="c1"># Single qubit rotations that are placed on all qubits with independent parameters</span>
    <span class="n">rotation_blocks</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ry&#39;</span><span class="p">,</span> <span class="s1">&#39;rz&#39;</span><span class="p">]</span>
    <span class="c1"># Entangling gates</span>
    <span class="n">entanglement_blocks</span> <span class="o">=</span> <span class="s1">&#39;cx&#39;</span>
    <span class="c1"># How the qubits are entangled </span>
    <span class="n">entanglement</span> <span class="o">=</span> <span class="s1">&#39;full&#39;</span>
    <span class="c1"># Repetitions of rotation_blocks + entanglement_blocks with independent parameters</span>
    <span class="n">repetitions</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="c1"># Skip the final rotation_blocks layer</span>
    <span class="n">skip_final_rotation_layer</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">ansatz</span> <span class="o">=</span> <span class="n">TwoLocal</span><span class="p">(</span><span class="n">qubit_op</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">rotation_blocks</span><span class="p">,</span> <span class="n">entanglement_blocks</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">repetitions</span><span class="p">,</span> 
                      <span class="n">entanglement</span><span class="o">=</span><span class="n">entanglement</span><span class="p">,</span> <span class="n">skip_final_rotation_layer</span><span class="o">=</span><span class="n">skip_final_rotation_layer</span><span class="p">)</span>
    <span class="c1"># Add the initial state</span>
    <span class="n">ansatz</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">init_state</span><span class="p">,</span> <span class="n">front</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
<span class="k">elif</span> <span class="n">ansatz_type</span> <span class="o">==</span> <span class="s2">&quot;UCCSD&quot;</span><span class="p">:</span>
    <span class="n">ansatz</span> <span class="o">=</span> <span class="n">UCCSD</span><span class="p">(</span><span class="n">converter</span><span class="p">,</span><span class="n">num_particles</span><span class="p">,</span><span class="n">num_spin_orbitals</span><span class="p">,</span><span class="n">initial_state</span> <span class="o">=</span> <span class="n">init_state</span><span class="p">)</span>
    
<span class="k">elif</span> <span class="n">ansatz_type</span> <span class="o">==</span> <span class="s2">&quot;PUCCD&quot;</span><span class="p">:</span>
    <span class="n">ansatz</span> <span class="o">=</span> <span class="n">PUCCD</span><span class="p">(</span><span class="n">converter</span><span class="p">,</span><span class="n">num_particles</span><span class="p">,</span><span class="n">num_spin_orbitals</span><span class="p">,</span><span class="n">initial_state</span> <span class="o">=</span> <span class="n">init_state</span><span class="p">)</span>
    
<span class="k">elif</span> <span class="n">ansatz_type</span> <span class="o">==</span> <span class="s2">&quot;SUCCD&quot;</span><span class="p">:</span>
    <span class="n">ansatz</span> <span class="o">=</span> <span class="n">SUCCD</span><span class="p">(</span><span class="n">converter</span><span class="p">,</span><span class="n">num_particles</span><span class="p">,</span><span class="n">num_spin_orbitals</span><span class="p">,</span><span class="n">initial_state</span> <span class="o">=</span> <span class="n">init_state</span><span class="p">)</span>
    
<span class="k">elif</span> <span class="n">ansatz_type</span> <span class="o">==</span> <span class="s2">&quot;EfficientSU2&quot;</span><span class="p">:</span>
    <span class="n">ansatz</span> <span class="o">=</span> <span class="n">EfficientSU2</span><span class="p">(</span><span class="n">num_qubits</span><span class="o">=</span><span class="n">qubit_op</span><span class="o">.</span><span class="n">num_qubits</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">entanglement</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">insert_barriers</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
<span class="n">ansatz</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="s1">&#39;mpl&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;iqx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Ethene_Workbook_28_0.png" src="../_images/Ethene_Workbook_28_0.png" />
</div>
</div>
<div class="section" id="backend-and-the-ibmq-experience">
<h2>Backend and the IBMQ Experience<a class="headerlink" href="#backend-and-the-ibmq-experience" title="Permalink to this headline">¶</a></h2>
<p>Now that you have <span class="math notranslate nohighlight">\(\psi(\vec\theta)\)</span> and <span class="math notranslate nohighlight">\(\hat{H}\)</span> in the translated is time to chose the solvers. <br>
As as well as the possible services that you have in the IBMQ experience service. <br></p>
<p>Nunerical solutions can be obtained localy using two solvers <code class="docutils literal notranslate"><span class="pre">NumPyMinimumEigensolver()</span></code> or numerical VQE using <code class="docutils literal notranslate"><span class="pre">QasmSimulatorPy()</span></code> as a backend</p>
<p>First of all you need to get an <em><a class="reference external" href="https://quantum-computing.ibm.com">account</a></em> at IBMQ experience andn get access to the service and a complete spectrum if rescources to start working with real quantun computers. <rb></p>
<p>Once you have access to your API Token you can copy it in credentials(‘API_token’). <br>
Now you need to look at your allowed providers by instanting its class. <br>
This will later allow access to the backends, where the job will take place. <br>
The list is divided in two main sections:</p>
<ul class="simple">
<li><p>Simulators</p>
<ul>
<li><p>Numerical simulators of several qubits and with specifil representations</p></li>
<li><p>Specific to problems</p></li>
<li><p>Easier access</p></li>
</ul>
</li>
<li><p>Systems
_ Limited number of qubits (max 15)</p>
<ul>
<li><p>Experimental error analysis</p></li>
<li><p>Eror correction implementaton algoritms</p></li>
<li><p>Longer queue</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">Aer</span>
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">IBMQ</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.aer.noise</span> <span class="kn">import</span> <span class="n">NoiseModel</span>
<span class="kn">from</span> <span class="nn">qiskit.utils</span> <span class="kn">import</span> <span class="n">QuantumInstance</span>
<span class="kn">from</span> <span class="nn">qiskit.ignis.mitigation.measurement</span> <span class="kn">import</span> <span class="n">CompleteMeasFitter</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.basicaer</span> <span class="kn">import</span> <span class="n">QasmSimulatorPy</span> 


<span class="n">Credentials</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&lt;Credential goes here!&gt;&#39;</span><span class="p">)</span>

<span class="n">IBMQ</span><span class="o">.</span><span class="n">load_account</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AccountProvider for IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="optimizer">
<h1>Optimizer<a class="headerlink" href="#optimizer" title="Permalink to this headline">¶</a></h1>
<p>In the case of optimizers, long can be discussed about the behavior of each parameters. <br>
For most of them the origina documentation is easily accessible.<br></p>
<ul class="simple">
<li><p><em><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin_l_bfgs_b.html">‘L_BFGS_B’</a></em></p></li>
<li><p><em><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">COBYLA</a></em></p></li>
<li><p><em><a class="reference external" href="https://www.jhuapl.edu/SPSA/">‘SPSA’</a></em></p></li>
<li><p><em><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">‘SLSQP’</a></em></p></li>
</ul>
<p>The number of iterations is just a simple parameter to approximate, buta longer iteration number than that would require problem reformulation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.algorithms.optimizers</span> <span class="kn">import</span> <span class="n">COBYLA</span><span class="p">,</span> <span class="n">L_BFGS_B</span><span class="p">,</span> <span class="n">SPSA</span><span class="p">,</span> <span class="n">SLSQP</span>

<span class="n">optimizer_type</span> <span class="o">=</span> <span class="s1">&#39;L_BFGS_B&#39;</span>

<span class="c1"># You may want to tune the parameters </span>
<span class="c1"># of each optimizer, here the defaults are used</span>
<span class="k">if</span> <span class="n">optimizer_type</span> <span class="o">==</span> <span class="s1">&#39;COBYLA&#39;</span><span class="p">:</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">COBYLA</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">optimizer_type</span> <span class="o">==</span> <span class="s1">&#39;L_BFGS_B&#39;</span><span class="p">:</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">L_BFGS_B</span><span class="p">(</span><span class="n">maxfun</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">optimizer_type</span> <span class="o">==</span> <span class="s1">&#39;SPSA&#39;</span><span class="p">:</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">SPSA</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="k">elif</span> <span class="n">optimizer_type</span> <span class="o">==</span> <span class="s1">&#39;SLSQP&#39;</span><span class="p">:</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">SLSQP</span><span class="p">(</span><span class="n">maxiter</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="solving-the-ground-state-energy">
<h1>Solving the Ground State Energy<a class="headerlink" href="#solving-the-ground-state-energy" title="Permalink to this headline">¶</a></h1>
<p>We call the function <code class="docutils literal notranslate"><span class="pre">GroundStateEigensolver</span></code> which requires inputs:<br></p>
<ul>
<li><p>converter</p>
<ul class="simple">
<li><p>Which is the problem mapped and translated in the correct formalism</p></li>
</ul>
</li>
<li><p>solver</p>
<ul class="simple">
<li><p>The engine which will simulate or coordinate the quantum computation of the quantum circuit generated by the ansatzs and qubit converter</p></li>
</ul>
<ul>
<li><p>NumPyMinimumEigensolverFactory()</p></li>
<li><p>NumPyMinimumEigensolver()</p></li>
<li><p>QasmSimulatorPy()</p></li>
<li><p>IBMQ_Backends</p>
<ul class="simple">
<li><p>Simulators</p></li>
</ul>
<ul class="simple">
<li><p>ibmq_qasm_simulator</p></li>
<li><p>simulator_statevector</p></li>
<li><p>simulator_stabilizer
-Systems</p></li>
<li><p>ibmq_manila</p></li>
<li><p>ibmq_santiago</p></li>
<li><p>1bmq_16_melbourne</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="classical-solution">
<h1>Classical solution<a class="headerlink" href="#classical-solution" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit_nature.algorithms.ground_state_solvers.minimum_eigensolver_factories</span> <span class="kn">import</span> <span class="n">NumPyMinimumEigensolverFactory</span>
<span class="kn">from</span> <span class="nn">qiskit_nature.algorithms.ground_state_solvers</span> <span class="kn">import</span> <span class="n">GroundStateEigensolver</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 

<span class="k">def</span> <span class="nf">exact_diagonalizer</span><span class="p">(</span><span class="n">problem</span><span class="p">,</span> <span class="n">converter</span><span class="p">):</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">NumPyMinimumEigensolverFactory</span><span class="p">()</span>
    <span class="n">calc</span> <span class="o">=</span> <span class="n">GroundStateEigensolver</span><span class="p">(</span><span class="n">converter</span><span class="p">,</span> <span class="n">solver</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">calc</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">problem</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">result_exact</span> <span class="o">=</span> <span class="n">exact_diagonalizer</span><span class="p">(</span><span class="n">es_problem</span><span class="p">,</span> <span class="n">converter</span><span class="p">)</span>
<span class="n">exact_energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">result_exact</span><span class="o">.</span><span class="n">eigenenergies</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exact electronic energy&quot;</span><span class="p">,</span> <span class="n">exact_energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result_exact</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exact electronic energy -4.0119475076527475
=== GROUND STATE ENERGY ===
 
* Electronic ground state energy (Hartree): -110.488118582658
  - computed part:      -4.011947507653
  - ActiveSpaceTransformer extracted energy part: -106.476171075005
~ Nuclear repulsion energy (Hartree): 33.369333067471
&gt; Total ground state energy (Hartree): -77.118785515187
 
=== MEASURED OBSERVABLES ===
 
  0:  # Particles: 4.000 S: 0.000 S^2: 0.000 M: 0.000
 
=== DIPOLE MOMENTS ===
 
~ Nuclear dipole moment (a.u.): [0.00018897  0.0  0.0]
 
  0: 
  * Electronic dipole moment (a.u.): [0.00018417  -0.00000265  0.0000002]
    - computed part:      [0.00049031  -0.00007902  0.00000602]
    - ActiveSpaceTransformer extracted energy part: [-0.00030614  0.00007637  -0.00000582]
  &gt; Dipole moment (a.u.): [0.0000048  0.00000265  -0.0000002]  Total: 0.00000549
                 (debye): [0.00001221  0.00000674  -0.00000051]  Total: 0.00001395
 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="vqe-and-initial-parameters-for-the-ansatz">
<h1>VQE and initial parameters for the ansatz<a class="headerlink" href="#vqe-and-initial-parameters-for-the-ansatz" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">qiskit.algorithms</span> <span class="kn">import</span> <span class="n">VQE</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">clear_output</span>
<span class="kn">from</span> <span class="nn">qiskit.providers.basicaer</span> <span class="kn">import</span> <span class="n">QasmSimulatorPy</span> 
<span class="kn">from</span> <span class="nn">qiskit</span> <span class="kn">import</span> <span class="n">Aer</span>

<span class="n">backend</span> <span class="o">=</span> <span class="n">Aer</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;statevector_simulator&#39;</span><span class="p">)</span>



<span class="c1"># Print and save the data in lists</span>
<span class="k">def</span> <span class="nf">callback</span><span class="p">(</span><span class="n">eval_count</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">):</span>  
    <span class="c1"># Overwrites the same line when printing</span>
    <span class="n">display</span><span class="p">(</span><span class="s2">&quot;Evaluation: </span><span class="si">{}</span><span class="s2">, Energy: </span><span class="si">{}</span><span class="s2">, Std: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eval_count</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="p">))</span>
    <span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">counts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eval_count</span><span class="p">)</span>
    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
    <span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
    <span class="n">deviation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>

<span class="n">counts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">deviation</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Set initial parameters of the ansatz</span>
<span class="c1"># We choose a fixed small displacement </span>
<span class="c1"># So all participants start from similar starting point</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">initial_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">ansatz</span><span class="o">.</span><span class="n">ordered_parameters</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">initial_point</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">]</span> <span class="o">*</span> <span class="n">ansatz</span><span class="o">.</span><span class="n">num_parameters</span>

<span class="n">algorithm</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">ansatz</span><span class="p">,</span>
                <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
                <span class="n">quantum_instance</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                <span class="n">callback</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
                <span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">algorithm</span><span class="o">.</span><span class="n">compute_minimum_eigenvalue</span><span class="p">(</span><span class="n">qubit_op</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OrderedDict([   (&#39;aux_operator_eigenvalues&#39;, None),
                (&#39;cost_function_evals&#39;, 297),
                (   &#39;eigenstate&#39;,
                    array([ 2.08584894e-19-2.05679253e-18j, -6.22335449e-17+4.88188034e-17j,
        3.58666317e-17+1.43335280e-18j,  1.05034627e-16+1.27957468e-18j,
       -1.69480814e-19-1.95349730e-18j, -3.32063121e-17-1.22159159e-17j,
       -1.16673452e-17-6.35244451e-17j,  2.54685368e-18-5.31246177e-17j,
       -4.76607245e-19+1.01223704e-20j, -1.64171363e-17+6.20091523e-18j,
       -1.64058363e-16+3.52025588e-17j, -1.36530694e-18+2.36908657e-17j,
        2.82334959e-18+1.70609309e-19j, -7.64549355e-18+8.51896604e-18j,
        3.10130829e-17+2.22392694e-17j, -1.54154348e-17+2.05464858e-17j,
        5.70213680e-18-3.15898858e-20j,  3.90407804e-17-5.65409829e-17j,
       -2.42749111e-17+2.76980820e-20j,  1.51765913e-15-8.19855193e-16j,
       -4.57057267e-19+1.61382451e-18j, -4.05665641e-17+1.57771471e-16j,
        4.41496178e-17+1.03329508e-16j, -3.59498618e-17-2.22423406e-17j,
        8.22679433e-19-2.37346163e-18j,  1.32456357e-17+2.20255065e-17j,
       -4.82335931e-17+2.17291987e-17j, -5.02909611e-17-3.35480990e-17j,
        1.66857477e-19-1.15136405e-18j, -1.59625692e-18+4.44580650e-18j,
        1.31763660e-17+2.61468456e-17j, -1.41179374e-17-3.13396798e-17j,
       -6.55692535e-19+6.98512503e-18j,  1.35340386e-17+9.47707010e-17j,
        5.55592672e-17-2.14132278e-18j,  1.65904594e-15-1.62774045e-15j,
       -1.09007109e-18+2.46360914e-18j,  7.42503829e-17-7.62305924e-17j,
        5.67082042e-17+1.15225586e-17j, -3.82061068e-17-9.04204473e-18j,
        2.72474285e-18+4.14550100e-18j,  1.51092668e-17+2.86161308e-17j,
       -3.31286770e-18+3.81168493e-17j, -2.14713713e-17-6.27038694e-17j,
       -4.05838004e-19+5.23499420e-19j, -1.87856876e-17+2.47830938e-17j,
        1.97716309e-18+3.74955225e-17j,  6.33660424e-17-1.06569468e-16j,
       -5.74011190e-17-5.72673012e-17j,  4.69845396e-16-3.46376154e-16j,
        4.31020549e-16-7.35360723e-16j,  9.67885186e-01-1.94690854e-15j,
       -3.47150975e-17+5.65157593e-18j,  7.34281148e-07-1.76956899e-17j,
        4.00950139e-07-1.04263952e-16j, -6.58210950e-16-7.98781896e-16j,
       -2.35704036e-16+4.72042828e-17j, -1.60344531e-06-6.83442640e-17j,
        7.63478698e-07+1.61373733e-16j, -9.27642995e-16-8.39147430e-16j,
       -4.52164378e-04-1.55852114e-17j,  4.25134675e-17+4.72854690e-17j,
       -2.51315189e-17+2.94466807e-17j,  3.38928889e-17-7.51751750e-17j,
       -1.74722801e-18-8.83433114e-19j,  7.81318642e-18+3.69256160e-18j,
       -1.35247637e-17+6.69200713e-18j,  5.50532238e-18-3.24640897e-17j,
       -1.33928809e-17+2.09267447e-18j, -4.27350098e-16+4.05979746e-16j,
        8.07869541e-17+5.24101772e-18j, -6.47720638e-17-3.68171876e-18j,
        1.01217594e-18+5.11554131e-19j, -3.40272561e-17+1.10311096e-18j,
       -5.24270578e-17+2.01853129e-17j,  5.45760249e-17+6.20999202e-17j,
        2.55400473e-18-1.08337220e-17j,  3.48105521e-17+2.79423147e-17j,
       -1.33950211e-18+9.99703511e-18j, -4.82029116e-18+6.48777819e-17j,
        2.84682860e-18+7.82855327e-19j, -7.37639113e-17-8.02706208e-18j,
        4.75140613e-18-3.95088484e-17j,  1.44063787e-06+4.39200451e-17j,
       -1.08994558e-16+1.89077662e-16j, -2.47862632e-01+4.65621218e-16j,
        8.43002472e-08-9.56721186e-19j,  9.15260685e-17+2.33204347e-17j,
        1.87770319e-18-6.00330194e-19j, -5.83204368e-07-1.86329027e-17j,
        1.03707695e-02-1.15206404e-17j,  4.32852438e-17-4.49916904e-17j,
       -1.88316423e-07-4.20091970e-17j,  2.01429499e-16+2.19720947e-16j,
        5.05744099e-18+2.37979639e-18j, -1.39966901e-17+3.17894849e-17j,
       -2.05509975e-20-6.22070760e-19j,  5.78830383e-18-4.39332942e-17j,
       -1.39187955e-17+2.17118975e-17j, -4.78581685e-08+1.38711265e-16j,
       -3.16850143e-18+4.15077774e-19j, -6.96984579e-09-1.04061509e-17j,
       -8.62895064e-03+8.23783826e-17j,  3.13438721e-17+7.24841558e-17j,
        1.03526100e-17-5.47638456e-18j,  1.08239057e-02-6.00211804e-17j,
       -3.22767322e-08+4.27217564e-17j,  8.25663464e-18-5.95128966e-18j,
       -1.83908717e-08-3.87449514e-19j,  6.41347945e-18+2.77555752e-17j,
       -2.54826544e-18+3.96514480e-18j, -1.74483999e-17-3.62293118e-17j,
        7.31652593e-19+3.60110611e-18j, -1.08075528e-17+5.20265207e-17j,
       -6.70285855e-17-5.60292577e-17j,  2.10387111e-16-1.90627184e-15j,
        1.20803276e-18-1.14716557e-18j,  1.94916411e-16+6.39779013e-17j,
        1.14617604e-16+1.92270594e-17j, -5.19978970e-18-3.02346296e-17j,
       -1.10868671e-18-5.43952340e-19j,  2.81301513e-17-4.06932172e-18j,
       -5.12767568e-17+2.04589179e-17j, -6.19066246e-17-1.36316410e-17j,
        1.60629262e-18+2.65806181e-19j,  4.89632584e-17-3.68469579e-18j,
       -3.03409611e-17+5.92596941e-17j, -4.32914887e-17-2.41062474e-17j,
       -1.33824654e-18-1.57387351e-18j,  1.12501446e-17-2.88032349e-17j,
       -6.96752429e-19-8.41440296e-18j,  1.27119148e-17+1.68478274e-16j,
        1.05180689e-18-1.20535580e-18j,  2.99394385e-17-2.15677176e-17j,
        2.43079285e-17-6.00493942e-17j, -1.33212444e-17+4.33628549e-17j,
        1.52691023e-18+3.19311173e-18j,  1.22524238e-17+2.37663537e-17j,
       -1.37074404e-17+5.33286815e-17j, -1.10324908e-16+1.02110872e-16j,
        8.03351624e-19-2.83252999e-18j, -3.63873426e-18+6.57189722e-18j,
       -2.36728078e-17+1.79894255e-18j, -2.19867693e-17+8.95196318e-17j,
        3.08020906e-18+1.96278146e-18j, -4.16112524e-18+3.52660029e-17j,
        6.26420394e-17+7.73944109e-17j, -1.25951246e-06+1.98403336e-16j,
        2.44849055e-18+4.54003833e-19j, -5.89178101e-07-4.37255093e-17j,
        1.08237019e-02+4.15940268e-17j,  9.88949462e-18-4.25300664e-17j,
       -3.26003725e-19+8.81602647e-18j, -6.08032145e-03+8.66785225e-17j,
       -3.83355543e-07+7.14937463e-18j, -6.45360448e-17-1.15087090e-16j,
        2.06071565e-08-2.46411739e-18j, -4.32666810e-17-1.70697901e-17j,
       -3.76002547e-17+3.92158118e-17j, -1.57711058e-16-3.33500334e-17j,
        5.23544482e-18-5.55983435e-18j, -1.48794191e-17+5.59754455e-17j,
       -1.06697134e-16+2.37239416e-16j,  7.64946544e-07-1.70059376e-17j,
        4.52967900e-18-1.21362617e-17j,  1.03709562e-02+8.57239550e-17j,
       -5.76866854e-08-6.34767951e-17j, -4.75603784e-17+6.07377362e-17j,
       -8.55323750e-18+6.84771156e-18j, -2.59457729e-07+4.99928596e-17j,
       -3.35038996e-02+2.54463597e-16j,  2.18530706e-16+1.63807289e-16j,
       -1.76352146e-08+1.92614822e-18j, -2.39192059e-17+5.91548925e-17j,
       -2.40349179e-18-1.13411497e-17j,  7.87310049e-17+7.01373899e-17j,
       -2.25516834e-18-2.18007554e-18j,  6.61274543e-18+6.19641576e-17j,
        4.97408520e-17+2.63869620e-17j, -1.25038720e-15-1.82725550e-15j,
       -8.34477682e-19-9.59230221e-19j, -6.72017224e-17-1.17612549e-16j,
       -4.44755066e-18-3.82528899e-17j, -5.78515754e-17-7.49237853e-17j,
        2.08656536e-18-1.14739249e-18j, -6.18005755e-17+5.59641505e-17j,
        6.65540247e-17+6.72855600e-17j,  2.94937337e-17+2.72974894e-17j,
       -2.14270319e-18-1.56183100e-18j,  7.47376923e-18-3.85501771e-17j,
        1.43249707e-16-7.56587596e-17j,  1.67576095e-16-5.22895591e-17j,
       -8.88379397e-19-1.57037224e-18j, -3.78343258e-17+5.23288654e-17j,
        6.07884162e-18-4.46534379e-17j, -4.52053640e-04-6.69248423e-17j,
        2.65413903e-17-5.98250459e-17j, -1.80784330e-07-6.45448994e-18j,
       -1.06054496e-08+3.59274294e-19j,  4.75994150e-18+9.48897202e-18j,
        2.32908793e-18-3.39061685e-18j,  1.45325857e-08+1.15541827e-17j,
       -4.21048879e-08-2.59853490e-17j,  3.78740143e-17+1.36334761e-17j,
        8.86649118e-03-6.67972140e-17j, -3.39371354e-17-7.09776523e-17j,
       -3.37974366e-18-9.59551606e-18j, -3.45614873e-17-2.67472157e-17j,
        6.39708104e-19-1.71281650e-18j, -6.88093132e-17+2.52150336e-17j,
        4.33217904e-17-2.34368213e-17j, -5.94761516e-17-1.05105173e-17j,
       -1.33518716e-17-7.33933684e-18j,  3.41179871e-16+4.66170893e-16j,
        1.63460795e-17+7.07178372e-18j,  7.73834023e-18-2.69516699e-17j,
        8.13027282e-19+1.17561622e-18j, -4.44981331e-18-4.25615636e-17j,
       -4.20299242e-17+1.33338012e-19j, -3.64047871e-17-1.15166025e-17j,
       -1.96301038e-17-2.05524976e-17j, -8.05937355e-18-5.98269445e-20j,
        1.79603917e-17-6.50595460e-18j, -1.89313822e-17-4.47796461e-17j,
        3.34627736e-18-4.99140173e-18j,  3.06192841e-17+8.21463220e-17j,
        1.72647070e-18-1.80099450e-17j, -3.95255956e-17+3.01089969e-17j,
        1.21441595e-18+1.58045934e-18j, -1.15406808e-19+3.37397056e-19j,
        1.72419736e-17-2.05421486e-18j,  1.58846100e-17+4.94199634e-17j,
        1.22558653e-18-8.06963086e-19j, -2.87865198e-17-1.87474388e-18j,
        2.00087495e-17-7.51321977e-17j,  9.63490944e-17+4.97431192e-17j,
       -6.72592276e-18-2.53972594e-18j, -2.85974046e-17-8.29415915e-18j,
        1.99839119e-17+4.15172380e-18j,  3.79640352e-17-1.45519128e-17j,
        1.40463289e-18+3.57121019e-18j, -4.11924310e-17-5.20205157e-18j,
       -2.20124549e-17-1.47063968e-17j,  1.33127767e-16-9.78914709e-17j,
       -1.20796627e-18-2.49366500e-18j, -2.42166167e-17+8.18925587e-18j,
       -8.90474643e-17+2.21094711e-17j,  5.31621578e-18+3.61826270e-18j,
        3.24364606e-19+2.89431529e-18j, -5.97551769e-17-1.92588604e-17j,
        1.72693061e-16+7.37254344e-17j, -3.95805036e-17-6.20755312e-17j,
       -4.79267085e-18+2.12502257e-18j, -1.03856672e-17+1.81890638e-17j,
        8.37796555e-19-3.52692945e-17j,  3.90055471e-17+5.69227105e-17j])),
                (&#39;eigenvalue&#39;, -4.011947500630809),
                (   &#39;optimal_parameters&#39;,
                    {   ParameterVectorElement(t[11]): -8.666506344104598e-08,
                        ParameterVectorElement(t[10]): -5.2379451993283155e-08,
                        ParameterVectorElement(t[25]): 0.0004670529258302915,
                        ParameterVectorElement(t[3]): -1.6036141320539185e-06,
                        ParameterVectorElement(t[1]): -7.8612330993902e-07,
                        ParameterVectorElement(t[2]): 7.348510342562673e-07,
                        ParameterVectorElement(t[0]): -4.012570449145045e-07,
                        ParameterVectorElement(t[5]): -7.853225947572057e-07,
                        ParameterVectorElement(t[6]): 1.4415795603317306e-06,
                        ParameterVectorElement(t[4]): 4.7654130332231554e-08,
                        ParameterVectorElement(t[20]): -6.086761718410654e-07,
                        ParameterVectorElement(t[22]): 2.680600201084175e-07,
                        ParameterVectorElement(t[24]): -0.0062819856055054924,
                        ParameterVectorElement(t[23]): -6.025409769173216e-07,
                        ParameterVectorElement(t[21]): -0.011182359156027851,
                        ParameterVectorElement(t[9]): -0.008684587915538602,
                        ParameterVectorElement(t[7]): -1.2596388478122883e-06,
                        ParameterVectorElement(t[8]): 0.00045630546657190107,
                        ParameterVectorElement(t[12]): -0.010922191056891632,
                        ParameterVectorElement(t[16]): 3.836424873259879e-07,
                        ParameterVectorElement(t[13]): -2.698973791194982e-08,
                        ParameterVectorElement(t[15]): -0.010378745275614273,
                        ParameterVectorElement(t[14]): -0.03462273429956178,
                        ParameterVectorElement(t[18]): -0.010378932055445001,
                        ParameterVectorElement(t[17]): 6.9750457152269435e-09,
                        ParameterVectorElement(t[19]): -0.2506793787384602}),
                (   &#39;optimal_point&#39;,
                    array([-4.01257045e-07, -5.23794520e-08, -8.66650634e-08, -1.09221911e-02,
       -2.69897379e-08, -3.46227343e-02, -1.03787453e-02,  3.83642487e-07,
        6.97504572e-09, -1.03789321e-02, -2.50679379e-01, -7.86123310e-07,
       -6.08676172e-07, -1.11823592e-02,  2.68060020e-07, -6.02540977e-07,
       -6.28198561e-03,  4.67052926e-04,  7.34851034e-07, -1.60361413e-06,
        4.76541303e-08, -7.85322595e-07,  1.44157956e-06, -1.25963885e-06,
        4.56305467e-04, -8.68458792e-03])),
                (&#39;optimal_value&#39;, -4.011947500630809),
                (&#39;optimizer_evals&#39;, 297),
                (&#39;optimizer_time&#39;, 24.683786869049072)])
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="simulation-on-the-ibmq-experience">
<h1>Simulation on the IBMQ Experience<a class="headerlink" href="#simulation-on-the-ibmq-experience" title="Permalink to this headline">¶</a></h1>
<p><strong>Please</strong> Be aware that online services require a queue and sometime long waiting lines for obtainig results. <br>
Be resonsible and be sensible with your usage of these services. <br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IBMQ</span><span class="o">.</span><span class="n">providers</span><span class="p">()</span> 
<span class="n">provider</span> <span class="o">=</span> <span class="n">IBMQ</span><span class="o">.</span><span class="n">get_provider</span><span class="p">(</span><span class="n">hub</span><span class="o">=</span><span class="s1">&#39;ibm-q&#39;</span><span class="p">)</span>  <span class="c1"># replace by your runtime provider</span>
<span class="nb">print</span><span class="p">(</span><span class="n">provider</span><span class="o">.</span><span class="n">backends</span><span class="p">())</span>
<span class="n">backend</span> <span class="o">=</span> <span class="n">provider</span><span class="o">.</span><span class="n">get_backend</span><span class="p">(</span><span class="s1">&#39;ibmq_qasm_simulator&#39;</span><span class="p">)</span> <span class="c1"># &lt; ------ this can also be a system</span>
<span class="nb">print</span><span class="p">(</span><span class="n">backend</span><span class="p">)</span>
<span class="n">coupling_map</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">configuration</span><span class="p">()</span><span class="o">.</span><span class="n">coupling_map</span>
<span class="c1">#noise_model = NoiseModel.from_backend(backend.properties())</span>
<span class="n">quantum_instance</span> <span class="o">=</span> <span class="n">QuantumInstance</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> 
                                   <span class="n">shots</span><span class="o">=</span><span class="mi">1020</span><span class="p">)</span>

<span class="n">algorithm</span> <span class="o">=</span> <span class="n">VQE</span><span class="p">(</span><span class="n">ansatz</span><span class="p">,</span>
                <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
                <span class="n">quantum_instance</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
                <span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">)</span>

<span class="n">Q_vqe_groundstate_solver</span> <span class="o">=</span> <span class="n">GroundStateEigensolver</span><span class="p">(</span><span class="n">converter</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">)</span>
<span class="n">Q_vqe_result</span> <span class="o">=</span> <span class="n">Q_vqe_groundstate_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">es_problem</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Energy:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Q_vqe_result</span><span class="o">.</span><span class="n">eigenenergies</span> <span class="o">+</span> <span class="n">Q_vqe_result</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">vqeprogram_result</span> <span class="o">=</span> <span class="n">vqe_result</span><span class="o">.</span><span class="n">raw_result</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;IBMQSimulator(&#39;ibmq_qasm_simulator&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQBackend(&#39;ibmqx2&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQBackend(&#39;ibmq_16_melbourne&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQBackend(&#39;ibmq_armonk&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQBackend(&#39;ibmq_athens&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQBackend(&#39;ibmq_santiago&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQBackend(&#39;ibmq_lima&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQBackend(&#39;ibmq_belem&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQBackend(&#39;ibmq_quito&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQSimulator(&#39;simulator_statevector&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQSimulator(&#39;simulator_mps&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQSimulator(&#39;simulator_extended_stabilizer&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQSimulator(&#39;simulator_stabilizer&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;, &lt;IBMQBackend(&#39;ibmq_manila&#39;) from IBMQ(hub=&#39;ibm-q&#39;, group=&#39;open&#39;, project=&#39;main&#39;)&gt;]
ibmq_qasm_simulator
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
/Users/rcp/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py:813: DeprecationWarning: Passing a Qobj to Backend.run is deprecated and will be removed in a future release. Please pass in circuits or pulse schedules instead.
  noise_model=noise_model, **run_config)
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">30</span><span class="o">-</span><span class="mf">9e7</span><span class="n">f11214872</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> 
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="n">Q_vqe_groundstate_solver</span> <span class="o">=</span> <span class="n">GroundStateEigensolver</span><span class="p">(</span><span class="n">converter</span><span class="p">,</span> <span class="n">algorithm</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">17</span> <span class="n">Q_vqe_result</span> <span class="o">=</span> <span class="n">Q_vqe_groundstate_solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">es_problem</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Energy:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">Q_vqe_result</span><span class="o">.</span><span class="n">eigenenergies</span> <span class="o">+</span> <span class="n">Q_vqe_result</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="g g-Whitespace">     </span><span class="mi">19</span> <span class="n">vqeprogram_result</span> <span class="o">=</span> <span class="n">vqe_result</span><span class="o">.</span><span class="n">raw_result</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit_nature/algorithms/ground_state_solvers/ground_state_eigensolver.py</span> in <span class="ni">solve</span><span class="nt">(self, problem, aux_operators)</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span>             <span class="n">aux_ops</span> <span class="o">=</span> <span class="kc">None</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span> 
<span class="ne">--&gt; </span><span class="mi">107</span>         <span class="n">raw_mes_result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solver</span><span class="o">.</span><span class="n">compute_minimum_eigenvalue</span><span class="p">(</span><span class="n">main_operator</span><span class="p">,</span> <span class="n">aux_ops</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span> 
<span class="g g-Whitespace">    </span><span class="mi">109</span>         <span class="n">result</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">interpret</span><span class="p">(</span><span class="n">raw_mes_result</span><span class="p">)</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/algorithms/minimum_eigen_solvers/vqe.py</span> in <span class="ni">compute_minimum_eigenvalue</span><span class="nt">(self, operator, aux_operators)</span>
<span class="g g-Whitespace">    </span><span class="mi">414</span>                                      <span class="n">cost_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_energy_evaluation</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">415</span>                                      <span class="n">gradient_fn</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_gradient</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">416</span>                                      <span class="n">optimizer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">417</span> 
<span class="g g-Whitespace">    </span><span class="mi">418</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_ret</span> <span class="o">=</span> <span class="n">VQEResult</span><span class="p">()</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/algorithms/variational_algorithm.py</span> in <span class="ni">find_minimum</span><span class="nt">(self, initial_point, ansatz, cost_fn, optimizer, gradient_fn)</span>
<span class="g g-Whitespace">    </span><span class="mi">218</span>                                                                       <span class="n">variable_bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">219</span>                                                                       <span class="n">initial_point</span><span class="o">=</span><span class="n">initial_point</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">220</span>                                                                       <span class="n">gradient_function</span><span class="o">=</span><span class="n">gradient_fn</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>         <span class="n">eval_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span> 

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/algorithms/optimizers/l_bfgs_b.py</span> in <span class="ni">optimize</span><span class="nt">(self, num_vars, objective_function, gradient_function, variable_bounds, initial_point)</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span>                                               <span class="n">initial_point</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">variable_bounds</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span>                                               <span class="n">fprime</span><span class="o">=</span><span class="n">gradient_function</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">100</span>                                               <span class="n">approx_grad</span><span class="o">=</span><span class="n">approx_grad</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_options</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span> 
<span class="g g-Whitespace">    </span><span class="mi">102</span>         <span class="k">return</span> <span class="n">sol</span><span class="p">,</span> <span class="n">opt</span><span class="p">,</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;funcalls&#39;</span><span class="p">]</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/scipy/optimize/lbfgsb.py</span> in <span class="ni">fmin_l_bfgs_b</span><span class="nt">(func, x0, fprime, args, approx_grad, bounds, m, factr, pgtol, epsilon, iprint, maxfun, maxiter, disp, callback, maxls)</span>
<span class="g g-Whitespace">    </span><span class="mi">196</span> 
<span class="g g-Whitespace">    </span><span class="mi">197</span>     <span class="n">res</span> <span class="o">=</span> <span class="n">_minimize_lbfgsb</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">jac</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">198</span>                            <span class="o">**</span><span class="n">opts</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">199</span>     <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;grad&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;jac&#39;</span><span class="p">],</span>
<span class="g g-Whitespace">    </span><span class="mi">200</span>          <span class="s1">&#39;task&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">],</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/scipy/optimize/lbfgsb.py</span> in <span class="ni">_minimize_lbfgsb</span><span class="nt">(fun, x0, args, jac, bounds, disp, maxcor, ftol, gtol, eps, maxfun, maxiter, iprint, callback, maxls, finite_diff_rel_step, **unknown_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">358</span>             <span class="c1"># until the completion of the current minimization iteration.</span>
<span class="g g-Whitespace">    </span><span class="mi">359</span>             <span class="c1"># Overwrite f and g:</span>
<span class="ne">--&gt; </span><span class="mi">360</span>             <span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">func_and_grad</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">361</span>         <span class="k">elif</span> <span class="n">task_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;NEW_X&#39;</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">362</span>             <span class="c1"># new iteration</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py</span> in <span class="ni">fun_and_grad</span><span class="nt">(self, x)</span>
<span class="g g-Whitespace">    </span><span class="mi">259</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_update_x_impl</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">260</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_update_fun</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">261</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_update_grad</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span>
<span class="g g-Whitespace">    </span><span class="mi">263</span> 

<span class="nn">~/anaconda3/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py</span> in <span class="ni">_update_grad</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">229</span>     <span class="k">def</span> <span class="nf">_update_grad</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span>         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">g_updated</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">231</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_update_grad_impl</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">232</span>             <span class="bp">self</span><span class="o">.</span><span class="n">g_updated</span> <span class="o">=</span> <span class="kc">True</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span> 

<span class="nn">~/anaconda3/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py</span> in <span class="ni">update_grad</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">ngev</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">approx_derivative</span><span class="p">(</span><span class="n">fun_wrapped</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">f0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">152</span>                                            <span class="o">**</span><span class="n">finite_diff_options</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span> 
<span class="g g-Whitespace">    </span><span class="mi">154</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_update_grad_impl</span> <span class="o">=</span> <span class="n">update_grad</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/scipy/optimize/_numdiff.py</span> in <span class="ni">approx_derivative</span><span class="nt">(fun, x0, method, rel_step, abs_step, f0, bounds, sparsity, as_linear_operator, args, kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">485</span>         <span class="k">if</span> <span class="n">sparsity</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">486</span>             <span class="k">return</span> <span class="n">_dense_difference</span><span class="p">(</span><span class="n">fun_wrapped</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">487</span>                                      <span class="n">use_one_sided</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">488</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">489</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">issparse</span><span class="p">(</span><span class="n">sparsity</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">sparsity</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/scipy/optimize/_numdiff.py</span> in <span class="ni">_dense_difference</span><span class="nt">(fun, x0, f0, h, use_one_sided, method)</span>
<span class="g g-Whitespace">    </span><span class="mi">555</span>             <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">h_vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">556</span>             <span class="n">dx</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">x0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Recompute dx as exactly representable number.</span>
<span class="ne">--&gt; </span><span class="mi">557</span>             <span class="n">df</span> <span class="o">=</span> <span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">f0</span>
<span class="g g-Whitespace">    </span><span class="mi">558</span>         <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;3-point&#39;</span> <span class="ow">and</span> <span class="n">use_one_sided</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span>             <span class="n">x1</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">h_vecs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/scipy/optimize/_numdiff.py</span> in <span class="ni">fun_wrapped</span><span class="nt">(x)</span>
<span class="g g-Whitespace">    </span><span class="mi">435</span> 
<span class="g g-Whitespace">    </span><span class="mi">436</span>     <span class="k">def</span> <span class="nf">fun_wrapped</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">437</span>         <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">438</span>         <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">439</span>             <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;`fun` return value has &quot;</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/scipy/optimize/_differentiable_functions.py</span> in <span class="ni">fun_wrapped</span><span class="nt">(x)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span>         <span class="k">def</span> <span class="nf">fun_wrapped</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span>             <span class="bp">self</span><span class="o">.</span><span class="n">nfev</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="ne">--&gt; </span><span class="mi">130</span>             <span class="k">return</span> <span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span> 
<span class="g g-Whitespace">    </span><span class="mi">132</span>         <span class="k">def</span> <span class="nf">update_fun</span><span class="p">():</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/algorithms/minimum_eigen_solvers/vqe.py</span> in <span class="ni">_energy_evaluation</span><span class="nt">(self, parameters)</span>
<span class="g g-Whitespace">    </span><span class="mi">464</span> 
<span class="g g-Whitespace">    </span><span class="mi">465</span>         <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">466</span>         <span class="n">sampled_expect_op</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_circuit_sampler</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_expect_op</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">param_bindings</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">467</span>         <span class="n">means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">sampled_expect_op</span><span class="o">.</span><span class="n">eval</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">468</span> 

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/opflow/converters/circuit_sampler.py</span> in <span class="ni">convert</span><span class="nt">(self, operator, params)</span>
<span class="g g-Whitespace">    </span><span class="mi">206</span>         <span class="n">p_b</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="n">Parameter</span><span class="p">,</span> <span class="nb">float</span><span class="p">]],</span> <span class="n">param_bindings</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">207</span>         <span class="n">sampled_statefn_dicts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_circuits</span><span class="p">(</span><span class="n">circuit_sfns</span><span class="o">=</span><span class="n">circs</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">208</span>                                                      <span class="n">param_bindings</span><span class="o">=</span><span class="n">p_b</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span> 
<span class="g g-Whitespace">    </span><span class="mi">210</span>         <span class="k">def</span> <span class="nf">replace_circuits_with_dicts</span><span class="p">(</span><span class="n">operator</span><span class="p">,</span> <span class="n">param_index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/opflow/converters/circuit_sampler.py</span> in <span class="ni">sample_circuits</span><span class="nt">(self, circuit_sfns, param_bindings)</span>
<span class="g g-Whitespace">    </span><span class="mi">308</span> 
<span class="g g-Whitespace">    </span><span class="mi">309</span>         <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantum_instance</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ready_circs</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">310</span>                                                 <span class="n">had_transpiled</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_transpile_before_bind</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span> 
<span class="g g-Whitespace">    </span><span class="mi">312</span>         <span class="k">if</span> <span class="n">param_bindings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_param_qobj</span><span class="p">:</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/utils/quantum_instance.py</span> in <span class="ni">execute</span><span class="nt">(self, circuits, had_transpiled)</span>
<span class="g g-Whitespace">    </span><span class="mi">409</span>             <span class="n">result</span> <span class="o">=</span> <span class="n">run_qobj</span><span class="p">(</span><span class="n">qobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_backend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_qjob_config</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">410</span>                               <span class="bp">self</span><span class="o">.</span><span class="n">_backend_options</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_noise_config</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">411</span>                               <span class="bp">self</span><span class="o">.</span><span class="n">_skip_qobj_validation</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_job_callback</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">412</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_time_taken</span> <span class="o">+=</span> <span class="n">result</span><span class="o">.</span><span class="n">time_taken</span>
<span class="g g-Whitespace">    </span><span class="mi">413</span> 

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/utils/run_circuits.py</span> in <span class="ni">run_qobj</span><span class="nt">(qobj, backend, qjob_config, backend_options, noise_config, skip_qobj_validation, job_callback)</span>
<span class="g g-Whitespace">    </span><span class="mi">258</span>     <span class="k">for</span> <span class="n">qob</span> <span class="ow">in</span> <span class="n">qobjs</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">259</span>         <span class="n">job</span><span class="p">,</span> <span class="n">job_id</span> <span class="o">=</span> <span class="n">_safe_submit_qobj</span><span class="p">(</span><span class="n">qob</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">260</span>                                         <span class="n">backend_options</span><span class="p">,</span> <span class="n">noise_config</span><span class="p">,</span> <span class="n">skip_qobj_validation</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">261</span>         <span class="n">job_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">262</span>         <span class="n">jobs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">job</span><span class="p">)</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/utils/run_circuits.py</span> in <span class="ni">_safe_submit_qobj</span><span class="nt">(qobj, backend, backend_options, noise_config, skip_qobj_validation)</span>
<span class="g g-Whitespace">    </span><span class="mi">146</span>             <span class="n">job</span> <span class="o">=</span> <span class="n">run_on_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">qobj</span><span class="p">,</span> <span class="n">backend_options</span><span class="o">=</span><span class="n">backend_options</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">147</span>                                  <span class="n">noise_config</span><span class="o">=</span><span class="n">noise_config</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">148</span>                                  <span class="n">skip_qobj_validation</span><span class="o">=</span><span class="n">skip_qobj_validation</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span>             <span class="n">job_id</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">job_id</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span>             <span class="k">break</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/utils/run_circuits.py</span> in <span class="ni">run_on_backend</span><span class="nt">(backend, qobj, backend_options, noise_config, skip_qobj_validation)</span>
<span class="g g-Whitespace">    </span><span class="mi">380</span>         <span class="k">return</span> <span class="n">job</span>
<span class="g g-Whitespace">    </span><span class="mi">381</span>     <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">382</span>         <span class="n">job</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qobj</span><span class="p">,</span> <span class="o">**</span><span class="n">backend_options</span><span class="p">,</span> <span class="o">**</span><span class="n">noise_config</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">383</span>         <span class="k">return</span> <span class="n">job</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/utils/deprecation.py</span> in <span class="ni">wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span>             <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span>                 <span class="n">_rename_kwargs</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">kwarg_map</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">56</span>             <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span>         <span class="k">return</span> <span class="n">wrapper</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span>     <span class="k">return</span> <span class="n">decorator</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py</span> in <span class="ni">run</span><span class="nt">(self, circuits, job_name, job_share_level, job_tags, experiment_id, validate_qobj, backend_options, noise_model, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">811</span>                            <span class="n">job_tags</span><span class="o">=</span><span class="n">job_tags</span><span class="p">,</span> <span class="n">experiment_id</span><span class="o">=</span><span class="n">experiment_id</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span>                            <span class="n">validate_qobj</span><span class="o">=</span><span class="n">validate_qobj</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">813</span>                            <span class="n">noise_model</span><span class="o">=</span><span class="n">noise_model</span><span class="p">,</span> <span class="o">**</span><span class="n">run_config</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">814</span> 
<span class="g g-Whitespace">    </span><span class="mi">815</span> 

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/utils/deprecation.py</span> in <span class="ni">wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">     </span><span class="mi">54</span>             <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">55</span>                 <span class="n">_rename_kwargs</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">kwarg_map</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">56</span>             <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">57</span>         <span class="k">return</span> <span class="n">wrapper</span>
<span class="g g-Whitespace">     </span><span class="mi">58</span>     <span class="k">return</span> <span class="n">decorator</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py</span> in <span class="ni">run</span><span class="nt">(self, circuits, job_name, job_share_level, job_tags, experiment_id, validate_qobj, header, shots, memory, qubit_lo_freq, meas_lo_freq, schedule_los, meas_level, meas_return, memory_slots, memory_slot_size, rep_time, rep_delay, init_qubits, parameter_binds, **run_config)</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span>             <span class="k">if</span> <span class="n">validate_qobj</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span>                 <span class="n">validate_qobj_against_schema</span><span class="p">(</span><span class="n">qobj</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">314</span>         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_submit_job</span><span class="p">(</span><span class="n">qobj</span><span class="p">,</span> <span class="n">job_name</span><span class="p">,</span> <span class="n">api_job_share_level</span><span class="p">,</span> <span class="n">job_tags</span><span class="p">,</span> <span class="n">experiment_id</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">315</span> 
<span class="g g-Whitespace">    </span><span class="mi">316</span>     <span class="k">def</span> <span class="nf">_get_run_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/ibmqbackend.py</span> in <span class="ni">_submit_job</span><span class="nt">(self, qobj, job_name, job_share_level, job_tags, experiment_id)</span>
<span class="g g-Whitespace">    </span><span class="mi">369</span>                 <span class="n">job_share_level</span><span class="o">=</span><span class="n">job_share_level</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">370</span>                 <span class="n">job_tags</span><span class="o">=</span><span class="n">job_tags</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">371</span>                 <span class="n">experiment_id</span><span class="o">=</span><span class="n">experiment_id</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">372</span>         <span class="k">except</span> <span class="n">ApiError</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">373</span>             <span class="k">if</span> <span class="s1">&#39;Error code: 3458&#39;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">):</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/api/clients/account.py</span> in <span class="ni">job_submit</span><span class="nt">(self, backend_name, qobj_dict, job_name, job_share_level, job_tags, experiment_id)</span>
<span class="g g-Whitespace">    </span><span class="mi">222</span>         <span class="k">try</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span>             <span class="c1"># Upload the Qobj to object storage.</span>
<span class="ne">--&gt; </span><span class="mi">224</span>             <span class="n">_</span> <span class="o">=</span> <span class="n">job_api</span><span class="o">.</span><span class="n">put_object_storage</span><span class="p">(</span><span class="n">upload_url</span><span class="p">,</span> <span class="n">qobj_dict</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span>             <span class="c1"># Notify the API via the callback.</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span>             <span class="n">response</span> <span class="o">=</span> <span class="n">job_api</span><span class="o">.</span><span class="n">callback_upload</span><span class="p">()</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/api/rest/job.py</span> in <span class="ni">put_object_storage</span><span class="nt">(self, url, qobj_dict)</span>
<span class="g g-Whitespace">    </span><span class="mi">189</span>         <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Uploading to object storage.&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">190</span>         <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">bare</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">191</span>                                     <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json&#39;</span><span class="p">})</span>
<span class="g g-Whitespace">    </span><span class="mi">192</span>         <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
<span class="g g-Whitespace">    </span><span class="mi">193</span> 

<span class="nn">~/anaconda3/lib/python3.7/site-packages/requests/sessions.py</span> in <span class="ni">put</span><span class="nt">(self, url, data, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">600</span>         <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">601</span><span class="sd"> </span>
<span class="ne">--&gt; </span><span class="mi">602</span><span class="sd">         return self.request(&#39;PUT&#39;, url, data=data, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">603</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">604</span><span class="sd">     def patch(self, url, data=None, **kwargs):</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/qiskit/providers/ibmq/api/session.py</span> in <span class="ni">request</span><span class="nt">(self, method, url, bare, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">269</span><span class="sd">         try:</span>
<span class="g g-Whitespace">    </span><span class="mi">270</span><span class="sd">             self._log_request_info(url, method, kwargs)</span>
<span class="ne">--&gt; </span><span class="mi">271</span><span class="sd">             response = super().request(method, final_url, headers=headers, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">272</span><span class="sd">             response.raise_for_status()</span>
<span class="g g-Whitespace">    </span><span class="mi">273</span><span class="sd">         except RequestException as ex:</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/requests/sessions.py</span> in <span class="ni">request</span><span class="nt">(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)</span>
<span class="g g-Whitespace">    </span><span class="mi">540</span><span class="sd">         }</span>
<span class="g g-Whitespace">    </span><span class="mi">541</span><span class="sd">         send_kwargs.update(settings)</span>
<span class="ne">--&gt; </span><span class="mi">542</span><span class="sd">         resp = self.send(prep, **send_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">543</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">544</span><span class="sd">         return resp</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/requests/sessions.py</span> in <span class="ni">send</span><span class="nt">(self, request, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">653</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">654</span><span class="sd">         # Send the request</span>
<span class="ne">--&gt; </span><span class="mi">655</span><span class="sd">         r = adapter.send(request, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">656</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">657</span><span class="sd">         # Total elapsed time of the request (approximately)</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/requests/adapters.py</span> in <span class="ni">send</span><span class="nt">(self, request, stream, timeout, verify, cert, proxies)</span>
<span class="g g-Whitespace">    </span><span class="mi">447</span><span class="sd">                     decode_content=False,</span>
<span class="g g-Whitespace">    </span><span class="mi">448</span><span class="sd">                     retries=self.max_retries,</span>
<span class="ne">--&gt; </span><span class="mi">449</span><span class="sd">                     timeout=timeout</span>
<span class="g g-Whitespace">    </span><span class="mi">450</span><span class="sd">                 )</span>
<span class="g g-Whitespace">    </span><span class="mi">451</span><span class="sd"> </span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/urllib3/connectionpool.py</span> in <span class="ni">urlopen</span><span class="nt">(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">704</span><span class="sd">                 body=body,</span>
<span class="g g-Whitespace">    </span><span class="mi">705</span><span class="sd">                 headers=headers,</span>
<span class="ne">--&gt; </span><span class="mi">706</span><span class="sd">                 chunked=chunked,</span>
<span class="g g-Whitespace">    </span><span class="mi">707</span><span class="sd">             )</span>
<span class="g g-Whitespace">    </span><span class="mi">708</span><span class="sd"> </span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/urllib3/connectionpool.py</span> in <span class="ni">_make_request</span><span class="nt">(self, conn, method, url, timeout, chunked, **httplib_request_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">392</span><span class="sd">                 conn.request_chunked(method, url, **httplib_request_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">393</span><span class="sd">             else:</span>
<span class="ne">--&gt; </span><span class="mi">394</span><span class="sd">                 conn.request(method, url, **httplib_request_kw)</span>
<span class="g g-Whitespace">    </span><span class="mi">395</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">396</span><span class="sd">         # We are swallowing BrokenPipeError (errno.EPIPE) since the server is</span>

<span class="nn">~/anaconda3/lib/python3.7/site-packages/urllib3/connection.py</span> in <span class="ni">request</span><span class="nt">(self, method, url, body, headers)</span>
<span class="g g-Whitespace">    </span><span class="mi">232</span><span class="sd">         if &quot;user-agent&quot; not in (six.ensure_str(k.lower()) for k in headers):</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span><span class="sd">             headers[&quot;User-Agent&quot;] = _get_default_user_agent()</span>
<span class="ne">--&gt; </span><span class="mi">234</span><span class="sd">         super(HTTPConnection, self).request(method, url, body=body, headers=headers)</span>
<span class="g g-Whitespace">    </span><span class="mi">235</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">236</span><span class="sd">     def request_chunked(self, method, url, body=None, headers=None):</span>

<span class="nn">~/anaconda3/lib/python3.7/http/client.py</span> in <span class="ni">request</span><span class="nt">(self, method, url, body, headers, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1275</span><span class="sd">                 encode_chunked=False):</span>
<span class="g g-Whitespace">   </span><span class="mi">1276</span><span class="sd">         &quot;&quot;&quot;</span><span class="n">Send</span> <span class="n">a</span> <span class="n">complete</span> <span class="n">request</span> <span class="n">to</span> <span class="n">the</span> <span class="n">server</span><span class="o">.</span><span class="s2">&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1277</span><span class="s2">         self._send_request(method, url, body, headers, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1278</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1279</span><span class="s2">     def _send_request(self, method, url, body, headers, encode_chunked):</span>

<span class="nn">~/anaconda3/lib/python3.7/http/client.py</span> in <span class="ni">_send_request</span><span class="nt">(self, method, url, body, headers, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1321</span><span class="s2">             # default charset of iso-8859-1.</span>
<span class="g g-Whitespace">   </span><span class="mi">1322</span><span class="s2">             body = _encode(body, &#39;body&#39;)</span>
<span class="ne">-&gt; </span><span class="mi">1323</span><span class="s2">         self.endheaders(body, encode_chunked=encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1324</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1325</span><span class="s2">     def getresponse(self):</span>

<span class="nn">~/anaconda3/lib/python3.7/http/client.py</span> in <span class="ni">endheaders</span><span class="nt">(self, message_body, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1270</span><span class="s2">         else:</span>
<span class="g g-Whitespace">   </span><span class="mi">1271</span><span class="s2">             raise CannotSendHeader()</span>
<span class="ne">-&gt; </span><span class="mi">1272</span><span class="s2">         self._send_output(message_body, encode_chunked=encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1273</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1274</span><span class="s2">     def request(self, method, url, body=None, headers=</span><span class="si">{}</span><span class="s2">, *,</span>

<span class="nn">~/anaconda3/lib/python3.7/http/client.py</span> in <span class="ni">_send_output</span><span class="nt">(self, message_body, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1069</span><span class="s2">                     chunk = f&#39;{len(chunk):X}</span><span class="se">\r\n</span><span class="s2">&#39;.encode(&#39;ascii&#39;) + chunk </span><span class="se">\</span>
<span class="g g-Whitespace">   </span><span class="mi">1070</span><span class="s2">                         + b&#39;</span><span class="se">\r\n</span><span class="s2">&#39;</span>
<span class="ne">-&gt; </span><span class="mi">1071</span><span class="s2">                 self.send(chunk)</span>
<span class="g g-Whitespace">   </span><span class="mi">1072</span><span class="s2"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1073</span><span class="s2">             if encode_chunked and self._http_vsn == 11:</span>

<span class="nn">~/anaconda3/lib/python3.7/http/client.py</span> in <span class="ni">send</span><span class="nt">(self, data)</span>
<span class="g g-Whitespace">    </span><span class="mi">991</span><span class="s2">             return</span>
<span class="g g-Whitespace">    </span><span class="mi">992</span><span class="s2">         try:</span>
<span class="ne">--&gt; </span><span class="mi">993</span><span class="s2">             self.sock.sendall(data)</span>
<span class="g g-Whitespace">    </span><span class="mi">994</span><span class="s2">         except TypeError:</span>
<span class="g g-Whitespace">    </span><span class="mi">995</span><span class="s2">             if isinstance(data, collections.abc.Iterable):</span>

<span class="nn">~/anaconda3/lib/python3.7/ssl.py</span> in <span class="ni">sendall</span><span class="nt">(self, data, flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1032</span><span class="s2">                 amount = len(byte_view)</span>
<span class="g g-Whitespace">   </span><span class="mi">1033</span><span class="s2">                 while count &lt; amount:</span>
<span class="ne">-&gt; </span><span class="mi">1034</span><span class="s2">                     v = self.send(byte_view[count:])</span>
<span class="g g-Whitespace">   </span><span class="mi">1035</span><span class="s2">                     count += v</span>
<span class="g g-Whitespace">   </span><span class="mi">1036</span><span class="s2">         else:</span>

<span class="nn">~/anaconda3/lib/python3.7/ssl.py</span> in <span class="ni">send</span><span class="nt">(self, data, flags)</span>
<span class="g g-Whitespace">   </span><span class="mi">1001</span><span class="s2">                     &quot;non-zero flags not allowed in calls to send() on </span><span class="si">%s</span><span class="s2">&quot; %</span>
<span class="g g-Whitespace">   </span><span class="mi">1002</span><span class="s2">                     self.__class__)</span>
<span class="ne">-&gt; </span><span class="mi">1003</span><span class="s2">             return self._sslobj.write(data)</span>
<span class="g g-Whitespace">   </span><span class="mi">1004</span><span class="s2">         else:</span>
<span class="g g-Whitespace">   </span><span class="mi">1005</span><span class="s2">             return super().send(data, flags)</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "QuESt-Calculator/QuESt",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="Water_bond_stretching.html" title="previous page">H2O Molecule <br></a>
    <a class='right-next' id="next-link" href="../README.html" title="next page">QuESt</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By QuESt team<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>